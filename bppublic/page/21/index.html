<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="onejustone&apos;s blog">
<meta property="og:type" content="website">
<meta property="og:title" content="onejustone">
<meta property="og:url" content="http://yoursite.com/page/21/index.html">
<meta property="og:site_name" content="onejustone">
<meta property="og:description" content="onejustone&apos;s blog">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="onejustone">
<meta name="twitter:description" content="onejustone&apos;s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/21/">





  <title>onejustone</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">onejustone</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">--愿你内心有种不灭的火焰，将你与别人区分开来--</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/17/Python网络(1)-socket简单编程/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/17/Python网络(1)-socket简单编程/" itemprop="url">Python网络(1)-socket简单编程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-17T10:21:00+08:00">
                2016-08-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>socke是进程间通信的一种方法，它是基于网络传输协议的上层接口，两个建立socket通信的进程可以分别属于两台不懂计算机。</p>
<p>双向管道(duplex PIPE)存活于同一台计算机,因此部分区分两台计算的地址，但是socket必须包含地址信息，以便实现网路通信。</p>
<p>一个socket包含四个地址信息:两台计算机的IP地址和两个进程所使用的端口(port)号。IP地址用于定位计算机，而port用于定位进程。</p>
<hr>
<h3 id="0x01-相关函数与模块"><a href="#0x01-相关函数与模块" class="headerlink" title="0x01 相关函数与模块"></a>0x01 相关函数与模块</h3><p>#### </p>
<hr>
<h3 id="0x02-编程实现sock-TCP连接"><a href="#0x02-编程实现sock-TCP连接" class="headerlink" title="0x02 编程实现sock TCP连接"></a>0x02 编程实现sock TCP连接</h3><p>socket有很多类型，比如基于TCP协议和UDO协议。其中又以TCP socket最常见。</p>
<p>TCP 是一种面向连接的传输层协议，TCP Socket 是基于一种 Client-Server 的编程模型，服务端监听客户端的连接请求，一旦建立连接即可以进行传输数据。那么对 TCP Socket 编程的介绍也分为客户端和服务端：</p>
<h4 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"># !/usr/bin/python</span><br><span class="line"># coding:utf-8</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"># 创建sokcet实例</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    # 如果创建失败，抛出socke.error异常</span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">except socket.error, msg:</span><br><span class="line">    print &apos;Failed to create socket.Error code:&apos; + str(msg[0]) + &apos;, Error message&apos; + msg[1]</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">print &apos;socket created&apos;</span><br><span class="line"></span><br><span class="line"># 连接服务器</span><br><span class="line"></span><br><span class="line"># 获得要连接的主机ip地址</span><br><span class="line">HOST = &apos;www.google.com&apos;</span><br><span class="line">PORT = 80</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    remote_ip = socket.gethostbyname(HOST)</span><br><span class="line">except socket.gaierror:</span><br><span class="line">    # 如果不能解析，抛出异常</span><br><span class="line">    print &quot;host name could not be resolved. Exiting&quot;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">print &apos;ip address of &apos; + HOST + &apos; is &apos; + remote_ip</span><br><span class="line"></span><br><span class="line"># 连接到服务器特定端口上</span><br><span class="line">s.connect((remote_ip, PORT))</span><br><span class="line"></span><br><span class="line">print &apos;Socket Connected to &apos; + HOST + &apos; on ip &apos; + remote_ip</span><br><span class="line"></span><br><span class="line"># 发送数据</span><br><span class="line">message = &apos;GET /HTTP/1.1 \r\n\r\n&apos;</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    s.sendall(message)</span><br><span class="line">except socket.error:</span><br><span class="line">    print &apos;send failed&apos;</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">print &apos;message send successfully&apos;</span><br><span class="line"></span><br><span class="line"># 数据发送完毕以后，客户端还得接受服务器的响应</span><br><span class="line">reply = s.recv(4096)</span><br><span class="line">print reply</span><br><span class="line"></span><br><span class="line"># 最后关闭socket连接</span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure>
<p>从上我们知道了:<br>1.创建 socket<br>2.连接到远程服务器<br>3.发送数据<br>4.接收数据<br>5.关闭 socket</p>
<p>当我们打开 <a href="http://www.google.com" target="_blank" rel="noopener">www.google.com</a> 时，浏览器所做的就是这些，知道这些是非常有意义的。在 socket 中具有这种行为特征的被称为<strong>CLIENT</strong>，客户端主要是连接远程系统获取数据。<br>socket 中另一种行为称为<strong>SERVER</strong>，服务器使用 socket 来接收连接以及提供数据，和客户端正好相反。所以 <a href="http://www.google.com" target="_blank" rel="noopener">www.google.com</a> 是服务器，你的浏览器是客户端，或者更准确地说，<a href="http://www.google.com" target="_blank" rel="noopener">www.google.com</a> 是 HTTP 服务器，你的浏览器是 HTTP 客户端。<br>那么上面介绍了客户端的编程，现在轮到服务器端如果使用 socket 了。</p>
<h4 id="服务器端"><a href="#服务器端" class="headerlink" title="服务器端"></a>服务器端</h4><p>服务器端主要做以下工作：<br>1.打开 socket<br>2.绑定到特定的地址以及端口上<br>3.监听连接<br>4.建立连接<br>5.接收/发送数据</p>
<p>上面已经介绍了如何创建 socket 了，下面一步是绑定。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"># !/usr/bin/python</span><br><span class="line"></span><br><span class="line"># coding:utf-8</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">HOST = &apos;&apos;</span><br><span class="line"># 意味着socket连接面向所有可以用的接口</span><br><span class="line">PORT = 8888</span><br><span class="line"></span><br><span class="line"># 创建一个socket实例</span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCKET_STREAM)</span><br><span class="line">print &apos;socket created&apos;</span><br><span class="line"></span><br><span class="line"># 开始绑定socket</span><br><span class="line"># 函数 bind 可以用来将 socket 绑定到特定的地址和端口上，</span><br><span class="line"># 它需要一个 sockaddr_in 结构作为参数：</span><br><span class="line">try:</span><br><span class="line">    s.bind(HOST, PORT)</span><br><span class="line">except socket.error, msg:</span><br><span class="line">    print &apos;Bind failed. Error code:&apos; + str(msg[0]) + &apos;message&apos; + msg[1]</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">print &apos;socket bind successfully&apos;</span><br><span class="line"></span><br><span class="line"># 开始监听</span><br><span class="line"># 该函数带有一个参数称为 backlog，用来控制连接的个数。</span><br><span class="line">s.listen(10)</span><br><span class="line">print &apos;socket now listening&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 接收连接</span><br><span class="line">conn, addr = s.accept()</span><br><span class="line"></span><br><span class="line"># display client information</span><br><span class="line">print &apos;connected with&apos; + addr[0] + &apos;:&apos; + str(addr[1])</span><br></pre></td></tr></table></figure>
<p>此时，该程序在 8888 端口上等待请求的到来。不要关掉这个程序，让它一直运行，现在客户端可以通过该端口连接到 socket。</p>
<p>下面要做的是，服务器建立连接之后，接收客户端发送来的数据，并立即将数据发送回去，下面是完整的服务端程序：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"># !/usr/bin/python</span><br><span class="line"># coding:utf-8</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">HOST = &apos;&apos;</span><br><span class="line"># 意味着socket连接面向所有可以用的接口</span><br><span class="line">PORT = 8888</span><br><span class="line"></span><br><span class="line"># 创建一个socket实例</span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">print &apos;socket created&apos;</span><br><span class="line"></span><br><span class="line"># 开始绑定socket</span><br><span class="line"># 函数 bind 可以用来将 socket 绑定到特定的地址和端口上，</span><br><span class="line"># 它需要一个 sockaddr_in 结构作为参数：</span><br><span class="line">try:</span><br><span class="line">    s.bind((HOST, PORT))</span><br><span class="line">except socket.error, msg:</span><br><span class="line">    print &apos;Bind failed. Error code:&apos; + str(msg[0]) + &apos;message&apos; + msg[1]</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">print &apos;socket bind successfully&apos;</span><br><span class="line"></span><br><span class="line"># 开始监听</span><br><span class="line"># 该函数带有一个参数称为 backlog，用来控制连接的个数。</span><br><span class="line">s.listen(10)</span><br><span class="line">print &apos;socket now listening&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 等待接收连接</span><br><span class="line">conn, addr = s.accept()</span><br><span class="line"></span><br><span class="line"># display client information</span><br><span class="line">print &apos;connected with&apos; + addr[0] + &apos;:&apos; + str(addr[1])</span><br><span class="line"></span><br><span class="line"># 现在，连接与客户端的会话</span><br><span class="line"># 接收来自客户端的数据</span><br><span class="line">data = conn.recv(1024)</span><br><span class="line"># 将数据原封不动的返回给客户端</span><br><span class="line">conn.sendall(data)</span><br><span class="line"></span><br><span class="line"># 关闭与客户端的数据连接</span><br><span class="line">conn.close()</span><br><span class="line"># 关闭socket</span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure>
<p>在一个终端中运行这个程序，打开另一个终端，使用 telnet 连接服务器，随便输入字符串，你会看到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> root  ~  PycharmProjects  First  1  telnet localhost 8888             1 </span><br><span class="line">Trying ::1...</span><br><span class="line">Trying 127.0.0.1...</span><br><span class="line">Connected to localhost.</span><br><span class="line">Escape character is &apos;^]&apos;.</span><br><span class="line">hello world!</span><br><span class="line">hello world!</span><br><span class="line">Connection closed by foreign host.</span><br></pre></td></tr></table></figure>
<p>客户端（telnet）接收了服务器的响应，单是在完成一次响应之后服务器立即断开了连接，而像 <a href="http://www.google.com" target="_blank" rel="noopener">www.google.com</a> 这样的服务器总是一直等待接收连接的。我们需要将上面的服务器程序改造成一直运行，最简单的办法是将 accept 放到一个循环中，那么就可以一直接收连接了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"># !/usr/bin/python</span><br><span class="line"># coding:utf-8</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">HOST = &apos;&apos;</span><br><span class="line"># 意味着socket连接面向所有可以用的接口</span><br><span class="line">PORT = 8888</span><br><span class="line"></span><br><span class="line"># 创建一个socket实例</span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">print &apos;socket created&apos;</span><br><span class="line"></span><br><span class="line"># 开始绑定socket</span><br><span class="line"># 函数 bind 可以用来将 socket 绑定到特定的地址和端口上，</span><br><span class="line"># 它需要一个 sockaddr_in 结构作为参数：</span><br><span class="line">try:</span><br><span class="line">    s.bind((HOST, PORT))</span><br><span class="line">except socket.error, msg:</span><br><span class="line">    print &apos;Bind failed. Error code:&apos; + str(msg[0]) + &apos;message&apos; + msg[1]</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">print &apos;socket bind successfully&apos;</span><br><span class="line"></span><br><span class="line"># 开始监听</span><br><span class="line"># 该函数带有一个参数称为 backlog，用来控制连接的个数。</span><br><span class="line">s.listen(10)</span><br><span class="line">print &apos;socket now listening&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 等待接收连接</span><br><span class="line">while 1:</span><br><span class="line">    conn, addr = s.accept()</span><br><span class="line">    # display client information</span><br><span class="line">    print &apos;connected with&apos; + addr[0] + &apos;:&apos; + str(addr[1])</span><br><span class="line">    # 现在，连接与客户端的会话</span><br><span class="line">    # 接收来自客户端的数据</span><br><span class="line">    data = conn.recv(1024)</span><br><span class="line">    reply = &apos;ok...&apos; + data</span><br><span class="line">    if not data:</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">    conn.sendall(data)</span><br><span class="line">    # 关闭与客户端的数据连接</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"># 关闭socket</span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure>
<p>现在开启三个终端，分别telnet服务器，会发现，如果一个终端连接之后不输入数据其他终端是没办法进行连接的，而且每个终端只能服务一次就断开连接。</p>
<p>但是，实际上确实需要多个客户端可以随时建立连接，而且每个客户端可以跟服务器进行多次通信，这该怎么修改呢？</p>
<h4 id="处理连接"><a href="#处理连接" class="headerlink" title="处理连接"></a>处理连接</h4><p>为了处理每个连接，我们需要将处理的程序与主程序的接收连接分开。一种方法可以使用线程来实现，主服务程序接收连接，创建一个线程来处理该连接的通信，然后服务器回到接收其他连接的逻辑上来。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"># !/usr/bin/python</span><br><span class="line"># coding:utf-8</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line">from thread import *</span><br><span class="line"></span><br><span class="line">HOST = &apos;&apos;</span><br><span class="line">PORT = 8888</span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">print &apos;socket created&apos;</span><br><span class="line"></span><br><span class="line"># 绑定本地主机和端口号</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    s.bind((HOST, PORT))</span><br><span class="line">except socket.error, msg:</span><br><span class="line">    print &apos;bind failed. Error code:&apos; + str(msg[0]) + &apos;message:&apos; + msg[1]</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">print &apos;socket bind complete&apos;</span><br><span class="line"></span><br><span class="line"># 开始监听</span><br><span class="line">s.listen(10)</span><br><span class="line">print &apos;Socket now listening&apos;</span><br><span class="line"></span><br><span class="line"># 函数用于处理数据，该函数将会用于创建线程</span><br><span class="line">def clientThread(conn):</span><br><span class="line">    # 发送消息给连接到服务器的客户端</span><br><span class="line">    conn.send(&apos;welcome to server.&apos;)</span><br><span class="line">    # 定义一个循环体，保证函数和线程的持续运行</span><br><span class="line">    while 1:</span><br><span class="line">        # 接收客户端的数据</span><br><span class="line">        data = conn.recv(1024)</span><br><span class="line">        rely = &apos;ok ...&apos; + data</span><br><span class="line">        if not data:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">        conn.sendall(rely)</span><br><span class="line"></span><br><span class="line">        # 退出循环时，关闭连接</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"># 保持与客户端的连接</span><br><span class="line">while True:</span><br><span class="line">    # 等待接收连接</span><br><span class="line">    conn, addr = s.accept()</span><br><span class="line">    print &apos;Connected with &apos; + addr[0] + &apos;:&apos; + str(addr[1])</span><br><span class="line">    # 开始一个新的的线程，start_new_thread的第一参数是要运行的函数名</span><br><span class="line">    # 第二个参数时该函数所需要的参数列表</span><br><span class="line">    start_new_thread(clientThread, (conn, ))</span><br><span class="line"></span><br><span class="line"># 最后关闭socket</span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure>
<p>本文参考链接: </p>
<blockquote>
<p><a href="http://www.cnblogs.com/hazir/p/python_socket_programming.html" target="_blank" rel="noopener">http://www.cnblogs.com/hazir/p/python_socket_programming.html</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/15/Django(1)-MyFirstView/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/15/Django(1)-MyFirstView/" itemprop="url">Django(1)-MyFirstView</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-15T00:00:00+08:00">
                2016-08-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-安装并创建第一个Django-Project"><a href="#0x00-安装并创建第一个Django-Project" class="headerlink" title="0x00 安装并创建第一个Django Project"></a>0x00 安装并创建第一个Django Project</h3><p>启动计算机中的Python，尝试载入Django模块。如果可以成功载入，那么说明Django已经安装好：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import django</span><br><span class="line">print (django.VERSION)</span><br></pre></td></tr></table></figure>
<p>这里的Django版本为1.10.</p>
<p>否则安装Django</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install django</span><br><span class="line">或者</span><br><span class="line">easy_install django</span><br></pre></td></tr></table></figure>
<p>Django安装完成，使用<code>django-admin startproject</code>命令创建一个网站根目录:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root ~ PycharmProjects 2 django-admin startproject mysite</span><br></pre></td></tr></table></figure>
<p>使用<code>tree</code>命令查看其目录结构:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> root ~ PycharmProjects mysite 2 tree</span><br><span class="line">.</span><br><span class="line">├── manage.py</span><br><span class="line">└── mysite</span><br><span class="line">    ├── __init__.py</span><br><span class="line">    ├── settings.py</span><br><span class="line">    ├── urls.py</span><br><span class="line">    └── wsgi.py</span><br><span class="line"></span><br><span class="line">1 directory, 5 files</span><br></pre></td></tr></table></figure>
<p>我们会发现执行命令后，新建了一个 <strong>mysite</strong> 目录，其中还有一个 <strong>mysite</strong> 目录，这个子目录 mysite 中是一些项目的设置 <strong>settings.py</strong> 文件，<br>总的urls配置文件 <strong>urls.py</strong> 以及部署服务器时用到的 <strong>wsgi.py</strong>  文件，  <strong><strong>init</strong>.py</strong> python包的目录结构必须的，与调用有关。</p>
<p>进入mysite目录,启动服务器 <strong>python mamage.py runserver</strong> 然后在浏览器中访问:localhsot:8000</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> root ~ PycharmProjects mysite 2 python manage.py runserver</span><br><span class="line">Performing system checks...</span><br><span class="line"></span><br><span class="line">System check identified no issues (0 silenced).</span><br><span class="line">August 15, 2016 - 03:15:32</span><br><span class="line">Django version 1.10, using settings &apos;mysite.settings&apos;</span><br><span class="line">Starting development server at http://127.0.0.1:8000/</span><br><span class="line">Quit the server with CONTROL-C.</span><br></pre></td></tr></table></figure>
<p>OK，这样便创建好了一个Django工程，下面在这个工程下添加第一个app。</p>
<hr>
<h3 id="0x01-创建第一个app"><a href="#0x01-创建第一个app" class="headerlink" title="0x01 创建第一个app"></a>0x01 创建第一个app</h3><p>使用<strong>python mamage.py startapp</strong>来创建一个app<br>app和project关系是，一个project可以包含多个app，一个app可以被多个project共享。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root ~ PycharmProjects mysite 2 python manage.py startapp polls</span><br><span class="line"> root ~ PycharmProjects mysite 2 tree polls</span><br><span class="line">polls</span><br><span class="line">├── admin.py</span><br><span class="line">├── apps.py</span><br><span class="line">├── __init__.py</span><br><span class="line">├── migrations</span><br><span class="line">│   └── __init__.py</span><br><span class="line">├── models.py</span><br><span class="line">├── tests.py</span><br><span class="line">└── views.py</span><br><span class="line"></span><br><span class="line">1 directory, 7 files</span><br></pre></td></tr></table></figure>
<p>app创建完成以后还需要在mysite/setting.py中添加app的实例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> root  ~  PycharmProjects  mysite  cat mysite/settings.py</span><br><span class="line"># Application definition</span><br><span class="line"></span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line">    &apos;django.contrib.admin&apos;,</span><br><span class="line">    &apos;django.contrib.auth&apos;,</span><br><span class="line">    &apos;django.contrib.contenttypes&apos;,</span><br><span class="line">    &apos;django.contrib.sessions&apos;,</span><br><span class="line">    &apos;django.contrib.messages&apos;,</span><br><span class="line">    &apos;django.contrib.staticfiles&apos;,</span><br><span class="line">    &apos;polls&apos;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>新建的 app 如果不加到<code>INSTALL_APPS</code>中的话, django 就不能自动找到app中的<strong>模板文件</strong>(<code>app-name/templates/</code>下的文件)和<strong>静态文件</strong>(<code>app-name/static/</code>中的文件) 。</p>
<h4 id="第一个view"><a href="#第一个view" class="headerlink" title="第一个view"></a>第一个view</h4><p>打开polls/view.py 并添加如下code：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from django.shortcuts import render</span><br><span class="line">from django.http import HttpResponse</span><br><span class="line"></span><br><span class="line"># Create your views here.</span><br><span class="line">def index(request):</span><br><span class="line">    return HttpResponse(&quot;&lt;p&gt;Hello, world.You&apos;re at the pools index.&lt;/p&gt;&quot;)</span><br></pre></td></tr></table></figure>
<p>声明编码为utf-8, 若是在代码中用到了中文,如果不声明就报错.</p>
<p>view的code写好了，那么便是需要为它创建URL映射了，当通过浏览器访问时才能得到polls.index页面的响应。</p>
<p>因此，还需要在polls目录下创建一个urls.py文件，添加完成以后的polls目录树如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> root ~ PycharmProjects mysite polls 2 tree</span><br><span class="line">.</span><br><span class="line">├── admin.py</span><br><span class="line">├── apps.py</span><br><span class="line">├── __init__.py</span><br><span class="line">├── migrations</span><br><span class="line">│   └── __init__.py</span><br><span class="line">├── models.py</span><br><span class="line">├── tests.py</span><br><span class="line">├── urls.py</span><br><span class="line">└── views.py</span><br><span class="line"></span><br><span class="line">1 directory, 8 files</span><br></pre></td></tr></table></figure>
<p>然后在polls/urls.py中添加如下code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from django.conf.urls import url</span><br><span class="line"></span><br><span class="line">from polls import views as polls_views</span><br><span class="line">#首先引用polls模块，作为视图并设置别名polls_views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(r&apos;^$&apos;, polls_views.index, name=&apos;index&apos;),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>接下来，需要使根目录下的URLconf指向<strong>polls.urls</strong>模块,那么需要在mysite/urls文件中引入<strong>import for django.conf.urls.include</strong>，并且在<strong>urlpatterns</strong>列表中插入<strong>include()</strong>方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> root ~ PycharmProjects mysite mysite 2 vim urls.py</span><br><span class="line">from django.conf.urls import url, include</span><br><span class="line">from django.contrib import admin</span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(r&apos;^admin/&apos;, admin.site.urls),</span><br><span class="line">    url(r&apos;^polls/&apos;, include(&apos;polls.urls&apos;)),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>最后，启动服务器:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root ~ PycharmProjects mysite 2 python manage.py runserver</span><br></pre></td></tr></table></figure>
<p>使用浏览器访问<a href="http://127.0.0.1:8000/polls/，可以看到:Hello" target="_blank" rel="noopener">http://127.0.0.1:8000/polls/，可以看到:Hello</a>, world.You’re at the pools index.</p>
<p>OK,到此，我们的第一Python app的第一view就创建成功， 接下来，该看看数据库了。</p>
<p>本文参考:django官方文档</p>
<blockquote>
<p><a href="https://media.readthedocs.org/pdf/django/1.10.x/django.pd" target="_blank" rel="noopener">https://media.readthedocs.org/pdf/django/1.10.x/django.pd</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/14/Python网络(2)-Python服务器进阶/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/14/Python网络(2)-Python服务器进阶/" itemprop="url">Python网络(2)-Python服务器进阶</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-14T20:21:00+08:00">
                2016-08-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/14/HTTP-请求and响应/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/14/HTTP-请求and响应/" itemprop="url">HTTP 请求/响应</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-14T00:00:00+08:00">
                2016-08-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p> http（超文本传输协议）是一个基于请求与响应模式的、无状态的、应用层的协议，常基于TCP的连接方式。无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。</p>
<hr>
<h3 id="0x01-HTTP协议之请求"><a href="#0x01-HTTP协议之请求" class="headerlink" title="0x01 HTTP协议之请求"></a>0x01 HTTP协议之请求</h3><p> http请求由三部分组成，分别是：请求行、消息报头、请求正文。</p>
<p>请求行以一个方法符号开头，以空格分开，后面跟着请求的URI和协议的版本，格式如下：Method Request-URI HTTP-Version CRLF  其中 Method表示请求方法；Request-URI是一个统一资源标识符；HTTP-Version表示请求的HTTP协议版本；CRLF表示回车和换行。</p>
<p>常用方法有:<br>GET     请求获取Request-URI所标识的资源<br>POST    在Request-URI所标识的资源后附加新的数据<br>HEAD    请求获取由Request-URI所标识的资源的响应消息报头</p>
<p>GET是请求服务器发送资源给客户，POST是请求服务器接收客户送来的数据。当我们打开一个网页时，我们通常是使用GET方法；当我们填写表格并提交时，我们通常使用POST方法。</p>
<p>比如:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /test.jpg HTTP/1.x</span><br><span class="line">Accept: text/*</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="0x02-HTTP协议之响应"><a href="#0x02-HTTP协议之响应" class="headerlink" title="0x02 HTTP协议之响应"></a>0x02 HTTP协议之响应</h3><p>HTTP响应也是由三个部分组成，分别是：状态行、消息报头、响应正文。</p>
<p>1、状态行格式如下：HTTP-Version Status-Code Reason-Phrase CRLF其中，HTTP-Version表示服务器HTTP协议的版本；Status-Code表示服务器发回的响应状态代码；Reason-Phrase表示状态代码的文本描述。</p>
<p>状态代码有三位数字组成，第一个数字定义了响应的类别，且有五种可能取值：<br>1xx：指示信息–表示请求已接收，继续处理<br>2xx：成功–表示请求已被成功接收、理解、接受<br>3xx：重定向–要完成请求必须进行更进一步的操作<br>4xx：客户端错误–请求有语法错误或请求无法实现<br>5xx：服务器端错误–服务器未能实现合法的请求常见状态代码、状态描述、<br>说明：<br>200 OK      //客户端请求成功<br>400 Bad Request  //客户端请求有语法错误，不能被服务器所理解401 Unauthorized //请求未经授权，这个状态代码必须和WWW-Authenticate报头域一起使用<br>403 Forbidden  //服务器收到请求，但是拒绝提供服务<br>404 Not Found  //请求资源不存在，eg：输入了错误的URL<br>500 Internal Server Error //服务器发生不可预期的错误<br>503 Server Unavailable  //服务器当前不能处理客户端的请求，一段时间后可能恢复正常</p>
<p> HTTP消息由客户端到服务器的请求和服务器到客户端的响应组成。请求消息和响应消息都是由开始行（对于请求消息，开始行就是请求行，对于响应消息，开始行就是状态行），消息报头（可选），空行（只有CRLF的行），消息正文（可选）组成。</p>
<p>比如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.x 200 OK  </span><br><span class="line">Content-Type:  text/html</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="0x03-HTTP协议之报头"><a href="#0x03-HTTP协议之报头" class="headerlink" title="0x03  HTTP协议之报头"></a>0x03  HTTP协议之报头</h3><p>HTTP消息由客户端到服务器的请求和服务器到客户端的响应组成。请求消息和响应消息都是由开始行（对于请求消息，开始行就是请求行，对于响应消息，开始行就是状态行），消息报头（可选），空行（只有CRLF的行），消息正文（可选）组成。</p>
<p>HTTP消息报头包括普通报头、请求报头、响应报头、实体报头。每一个报头域都是由名字+“：”+空格+值 组成，消息报头域的名字是大小写无关的。</p>
<p>比如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Type:  image/jpg</span><br></pre></td></tr></table></figure>
<h4 id="普通报头"><a href="#普通报头" class="headerlink" title="普通报头"></a>普通报头</h4><p>Cache-Control   用于指定缓存指令，缓存指令是单向的（响应中出现的缓存指令在请求中未必会出现），且是独立的（一个消息的缓存指令不会影响另一个消息处理的缓存机制），HTTP1.0使用的类似的报头域为Pragma。请求时的缓存指令包括：no-cache（用于指示请求或响应消息不能缓存）、no-store、max-age、max-stale、min-fresh、only-if-cached;响应时的缓存指令包括：public、private、no-cache、no-store、no-transform、must-revalidate、proxy-revalidate、max-age、s-maxage.eg：为了指示IE浏览器（客户端）不要缓存页面，服务器端的JSP程序可以编写如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response.sehHeader(&quot;Cache-Control&quot;,&quot;no-cache&quot;);</span><br><span class="line">//response.setHeader(&quot;Pragma&quot;,&quot;no-cache&quot;);</span><br><span class="line">//作用相当于上述代码，通常两者//合用这句代码将在发送的响应</span><br></pre></td></tr></table></figure>
<p>消息中设置普通报头域：Cache-Control:no-cache。</p>
<p>Date普通报头域表示消息产生的日期和时间。</p>
<p>Connection普通报头域允许发送指定连接的选项。例如指定连接是连续，或者指定“close”选项，通知服务器，在响应完成后，关闭连接。</p>
<h4 id="请求报头"><a href="#请求报头" class="headerlink" title="请求报头"></a>请求报头</h4><p>请求报头允许客户端向服务器端传递请求的附加信息以及客户端自身的信息。</p>
<p>User-Agent：<br>User-Agent请求报头域允许客户端将它的操作系统、浏览器和其它属性告诉服务器。不过，这个报头域不是必需的，如果我们自己编写一个浏览器，不使用User-Agent请求报头域，那么服务器端就无法得知我们的信息了。</p>
<p>Accept<br>Accept请求报头域用于指定客户端接受哪些类型的信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Accept： image/gif，表明客户端希望接受GIF图象格式的资源；</span><br><span class="line">Accept： text/html，表明客户端希望接受html文本。</span><br></pre></td></tr></table></figure>
<p>Accept-Charset<br>Accept-Charset请求报头域用于指定客户端接受的字符集。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Accept-Charset: iso-8859-1,gb2312</span><br><span class="line">如果在请求消息中没有设置这个域，缺省是任何字符集都可以接受。</span><br></pre></td></tr></table></figure>
<p>Accept-Encoding<br>Accept-Encoding请求报头域类似于Accept，但是它是用于指定可接受的内容编码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Accept-Encoding: gzip.deflate.</span><br><span class="line">如果请求消息中没有设置这个域服务器假定客户端对各种内容编码都可以接受。</span><br></pre></td></tr></table></figure>
<p>Accept-Language<br>Accept-Language请求报头域类似于Accept，但是它是用于指定一种自然语言。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Accept-Language:  zh-cn.</span><br><span class="line">如果请求消息中没有设置这个报头域，服务器假定客户端对各种语言都可以接受。</span><br></pre></td></tr></table></figure>
<p>Authorization<br>Authorization请求报头域主要用于证明客户端有权查看某个资源。当浏览器访问一个页面时，如果收到服务器的响应代码为401（未授权），可以发送一个包含Authorization请求报头域的请求，要求服务器对其进行验证。</p>
<p>Host（发送请求时，该报头域是必需的）<br>Host请求报头域主要用于指定被请求资源的Internet主机和端口号，它通常从HTTP URL中提取出来的。</p>
<h4 id="响应报头"><a href="#响应报头" class="headerlink" title="响应报头"></a>响应报头</h4><p>响应报头允许服务器传递不能放在状态行中的附加响应信息，以及关于服务器的信息和对Request-URI所标识的资源进行下一步访问的信息。</p>
<p>Location<br>Location响应报头域用于重定向接受者到一个新的位置。Location响应报头域常用在更换域名的时候。</p>
<p>Server<br>Server响应报头域包含了服务器用来处理请求的软件信息。与User-Agent请求报头域是相对应的。下面是Server响应报头域的一个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Server：Apache-Coyote/1.1</span><br></pre></td></tr></table></figure>
<p>WWW-Authenticate<br>WWW-Authenticate响应报头域必须被包含在401（未授权的）响应消息中，客户端收到401响应消息时候，并发送Authorization报头域请求服务器对其进行验证时，服务端响应报头就包含该报头域。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WWW-Authenticate:Basic realm=&quot;Basic Auth Test!&quot;  //可以看出服务器对请求资源采用的是基本验证机制。</span><br></pre></td></tr></table></figure>
<h4 id="实体报头"><a href="#实体报头" class="headerlink" title="实体报头"></a>实体报头</h4><p>请求和响应消息都可以传送一个实体。一个实体由实体报头域和实体正文组成，但并不是说实体报头域和实体正文要在一起发送，可以只发送实体报头域。</p>
<p>Content-Encoding<br>Content-Encoding实体报头域被用作媒体类型的修饰符，它的值指示了已经被应用到实体正文的附加内容的编码，因而要获得Content-Type报头域中所引用的媒体类型，必须采用相应的解码机制。</p>
<p>Content-Encoding这样用于记录文档的压缩方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">content-Encoding：gzip</span><br></pre></td></tr></table></figure>
<p>Content-Language<br>Content-Language实体报头域描述了资源所用的自然语言。没有设置该域则认为实体内容将提供给所有的语言阅读者。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Language:da</span><br></pre></td></tr></table></figure>
<p>Content-Length<br>Content-Length实体报头域用于指明实体正文的长度，以字节方式存储的十进制数字来表示。</p>
<p>Content-Type<br>Content-Type实体报头域用语指明发送给接收者的实体正文的媒体类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-Type: text/html;charset=ISO-8859-1</span><br><span class="line">Content-Type: text/html;charset=GB2312L</span><br><span class="line">Content-Type: text/image</span><br></pre></td></tr></table></figure>
<p>Last-Modified<br>Last-Modified实体报头域用于指示资源的最后修改日期和时间。</p>
<p>Expires<br>Expires实体报头域给出响应过期的日期和时间。为了让代理服务器或浏览器在一段时间以后更新缓存中(再次访问曾访问过的页面时，直接从缓存中加载，缩短响应时间和降低服务器负载)的页面，我们可以使用Expires实体报头域指定页面过期的时间。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Expires：Thu，15 Sep 2006 16:23:12 GMT</span><br></pre></td></tr></table></figure>
<p>HTTP1.1的客户端和缓存必须将其他非法的日期格式（包括0）看作已经过期。</p>
<p>为了让浏览器不要缓存页面，我们也可以利用Expires实体报头域，设置为0，jsp中程序:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setDateHeader(&quot;Expires&quot;,&quot;0&quot;);</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="0x04-基于HTTP协议的攻击面"><a href="#0x04-基于HTTP协议的攻击面" class="headerlink" title="0x04 基于HTTP协议的攻击面"></a>0x04 基于HTTP协议的攻击面</h3><h4 id="HTTP协议Content-Lenth限制漏洞导致拒绝服务攻击"><a href="#HTTP协议Content-Lenth限制漏洞导致拒绝服务攻击" class="headerlink" title="HTTP协议Content Lenth限制漏洞导致拒绝服务攻击"></a>HTTP协议Content Lenth限制漏洞导致拒绝服务攻击</h4><p>使用POST方法时，可以设置ContentLenth来定义需要传送的数据长度，例如ContentLenth:999999999，在传送完成前，内 存不会释放，攻击者可以利用这个缺陷，连续向WEB服务器发送垃圾数据直至WEB服务器内存耗尽。这种攻击方法基本不会留下痕迹。</p>
<h4 id="利用HTTP协议的特性进行拒绝服务攻击的一些构思"><a href="#利用HTTP协议的特性进行拒绝服务攻击的一些构思" class="headerlink" title="利用HTTP协议的特性进行拒绝服务攻击的一些构思"></a>利用HTTP协议的特性进行拒绝服务攻击的一些构思</h4><p>服务器端忙于处理攻击者伪造的TCP连接请求而无暇理睬客户的正常请求（毕竟客户端的正常请求比率非常之小），此时从正常客户的角度看来，服务器失去响应，这种情况我们称作：服务器端受到了SYNFlood攻击（SYN洪水攻击）</p>
<p>19端口在早期已经有人用来做Chargen攻击了，即Chargen_Denial_of_Service，但是！他们用的方法是在两台Chargen 服务器之间产生UDP连接，让服务器处理过多信息而DOWN掉，那么，干掉一台WEB服务器的条件就必须有2个：1.有Chargen服务2.有HTTP 服务方法：攻击者伪造源IP给N台Chargen发送连接请求（Connect），Chargen接收到连接后就会返回每秒72字节的字符流（实际上根据网络实际情况，这个速度更快）给服务器。</p>
<h4 id="Http指纹识别技术"><a href="#Http指纹识别技术" class="headerlink" title="Http指纹识别技术"></a>Http指纹识别技术</h4><p>要让服务器返回不同的Banner信息的设置是很简单的,象Apache这样的开放源代码的Http服务器,用户可以在源代码里修改Banner信息,然 后重起Http服务就生效了；对于没有公开源代码的Http服务器比如微软的IIS或者是Netscape,可以在存放Banner信息的Dll文件中修改。而另外一种模糊Banner信息的方法是使用插件。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/10/Django博客(3)Admin/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/10/Django博客(3)Admin/" itemprop="url">Django博客(3)Admin</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-10T00:00:00+08:00">
                2016-08-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-创建admin账号"><a href="#0x00-创建admin账号" class="headerlink" title="0x00 创建admin账号"></a>0x00 创建admin账号</h3><p>运行如下命令创建admin账号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py createsuperuser</span><br><span class="line">Username (leave blank to use &apos;root&apos;): jack</span><br><span class="line">Email address: 1234@gmail.com</span><br><span class="line">Password: qwer7890</span><br><span class="line">Password (again):</span><br></pre></td></tr></table></figure>
<p>更具提示输入admin的名称，邮箱，密码。</p>
<p>最后启动服务器，访问 IP:8080/amdin，就可以进入管理员页面了。</p>
<hr>
<h4 id="将app-注册到Django管理员站点"><a href="#将app-注册到Django管理员站点" class="headerlink" title="将app 注册到Django管理员站点"></a>将app 注册到Django管理员站点</h4><p>编辑 <code>article/admin.py</code> 添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from django.contrib import admin</span><br><span class="line">from article.models import Article</span><br><span class="line"></span><br><span class="line"># Register your models here.</span><br><span class="line">admin.site.register(Article)</span><br></pre></td></tr></table></figure>
<p>启动Diango服务器，便可以对 Article 站点页面进行页面管理了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/10/Django博客(4)View,Urls/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/10/Django博客(4)View,Urls/" itemprop="url">Django博客(4)View,Urls</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-10T00:00:00+08:00">
                2016-08-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x01-网页逻辑"><a href="#0x01-网页逻辑" class="headerlink" title="0x01 网页逻辑"></a>0x01 网页逻辑</h3><ul>
<li><p>url设置相当于客户端向服务器发出request请求的入口, 并用来指明要调用的程序逻辑</p>
</li>
<li><p>views用来处理程序逻辑, 然后呈现到template(一般为GET方法, POST方法略有不同)</p>
</li>
<li><p>models用封装和处理数据库相关操作和数据</p>
</li>
<li><p>template一般为html+CSS的形式, 主要是呈现给用户的表现形式</p>
</li>
</ul>
<hr>
<h3 id="0x02-view-和-urls"><a href="#0x02-view-和-urls" class="headerlink" title="0x02 view 和 urls"></a>0x02 view 和 urls</h3><p>先在 my_blog/article/view 中添加如下代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>为了将上述 view 逻辑在 http 请求时被调用，便需要在 articel/urls 中进行配置。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/05/Django博客(1)Apache2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/05/Django博客(1)Apache2/" itemprop="url">Django博客(1)Apache2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-05T00:00:00+08:00">
                2016-08-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-部署前的准备"><a href="#0x00-部署前的准备" class="headerlink" title="0x00 部署前的准备"></a>0x00 部署前的准备</h3><p>假设你已经有了一个云服务器，并且操作系统是 Ubuntu 14.4。</p>
<p>首先添加一个新的非 root 账号，为了安全起见，并为其赋予 sudo 权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo adduser onejustone</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sudoers</span><br><span class="line">#在 root ALL=(ALL:ALL)ALL 下添加</span><br><span class="line">onejustone ALL=(ALL:ALL)ALL</span><br></pre></td></tr></table></figure>
<p>切换用户到 onejustone</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su onejustone</span><br></pre></td></tr></table></figure>
<h4 id="安装-virtualenv"><a href="#安装-virtualenv" class="headerlink" title="安装 virtualenv"></a>安装 virtualenv</h4><p><code>virtualenv</code> 算是 Python 世界中的几大神器之一。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#安装 virtualenv</span><br><span class="line">sudo apt-get install python-virtualenv</span><br><span class="line"></span><br><span class="line">#创建一个新的虚拟环境,名为 ENV</span><br><span class="line">virtualenv ENV</span><br><span class="line"></span><br><span class="line">#启动 ENV</span><br><span class="line">source ENV/bin/activate</span><br></pre></td></tr></table></figure>
<p>在虚拟环境中安装 Django</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(ENV)onejustone@ubuntu:~$:pip install django</span><br></pre></td></tr></table></figure>
<p>如需退出虚拟环境，使用:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(ENV)onejustone@ubuntu:~$:deactivate</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="0x01-安装数据库和-HTTP-服务器"><a href="#0x01-安装数据库和-HTTP-服务器" class="headerlink" title="0x01 安装数据库和 HTTP 服务器"></a>0x01 安装数据库和 HTTP 服务器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#安装 mysql 服务器</span><br><span class="line">sudo apt-get install mysql-server</span><br><span class="line"></span><br><span class="line">#安装客户工具</span><br><span class="line">sudo apt-get install libmysqlclient-dev</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#安装 apache2 以及 mod-wsgi</span><br><span class="line">sudo apt-get install apache2</span><br><span class="line">sudo apt-get install libapache2-mod-wsgi</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="0x02-开启-Django"><a href="#0x02-开启-Django" class="headerlink" title="0x02 开启 Django"></a>0x02 开启 Django</h3><p>由于我们使用了virtualenv来安装Django，所以Django并不在系统的默认路径上。为了让系统正常运行，还需要在wsgi.py中加入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line"></span><br><span class="line"># 加入virtualenv的路径</span><br><span class="line">sys.path.append(&apos;/home/onejustone/ENV/lib/python2.7/site-packages&apos;)</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="0x03-创建Django-项目"><a href="#0x03-创建Django-项目" class="headerlink" title="0x03 创建Django 项目"></a>0x03 创建Django 项目</h3><h4 id="创建一个-my-blog-的Django-项目"><a href="#创建一个-my-blog-的Django-项目" class="headerlink" title="创建一个 my_blog 的Django 项目"></a>创建一个 my_blog 的Django 项目</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ django-admin.py startproject my_blog</span><br></pre></td></tr></table></figure>
<h4 id="创建一个-article-app"><a href="#创建一个-article-app" class="headerlink" title="创建一个 article app"></a>创建一个 article app</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py startapp article</span><br></pre></td></tr></table></figure>
<h4 id="在-my-blog-my-blog-setting-py-下添加新建app"><a href="#在-my-blog-my-blog-setting-py-下添加新建app" class="headerlink" title="在 my_blog/my_blog/setting.py 下添加新建app"></a>在 my_blog/my_blog/setting.py 下添加新建app</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = (</span><br><span class="line">    ...</span><br><span class="line">    &apos;article&apos;,  #这里填写的是app的名称</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="在-my-blog-my-blog-urls-py-中配置-url"><a href="#在-my-blog-my-blog-urls-py-中配置-url" class="headerlink" title="在 my_blog/my_blog/urls.py 中配置 url"></a>在 my_blog/my_blog/urls.py 中配置 url</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from django.conf.urls import url, include</span><br><span class="line">from django.contrib import admin</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(r&apos;^admin/&apos;, admin.site.urls),</span><br><span class="line">    url(r&apos;^article/&apos;, include(&apos;article.urls&apos;)),</span><br></pre></td></tr></table></figure>
<h4 id="在my-blog-article-中添加一个新的-urls-py-文件"><a href="#在my-blog-article-中添加一个新的-urls-py-文件" class="headerlink" title="在my_blog/article 中添加一个新的 urls.py 文件"></a>在my_blog/article 中添加一个新的 urls.py 文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from django.conf.urls import url</span><br><span class="line">from article import views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(r&apos;^$&apos;, view.first_page, name=&apos;first_age&apos;),</span><br></pre></td></tr></table></figure>
<h4 id="在article-views-py-中添加如下业务代码"><a href="#在article-views-py-中添加如下业务代码" class="headerlink" title="在article/views.py 中添加如下业务代码"></a>在article/views.py 中添加如下业务代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from django.shortcuts import render</span><br><span class="line">from django.http import HttpResponse</span><br><span class="line">def first_page(request):</span><br><span class="line">    return HttpResponse(&quot;&lt;p&gt;hello, world&lt;/p&gt;&quot;)</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="0x04-配置-Apach2"><a href="#0x04-配置-Apach2" class="headerlink" title="0x04 配置 Apach2"></a>0x04 配置 Apach2</h3><p>在apache的配置文件/etc/apache2/apache2.conf中增加下面的配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># Django</span><br><span class="line">WSGIScriptAlias / /home/onejustone/my_blog/my_blog/wsgi.py</span><br><span class="line">#django 自带的 wsgi.py 文件</span><br><span class="line">WSGIPythonPath /home/onejuston/my_blog</span><br><span class="line">#django 项目所在位置</span><br><span class="line"></span><br><span class="line">&lt;Directory /home/onejustone/my_blog/my_blog&gt;</span><br><span class="line">#站点位置</span><br><span class="line">&lt;Files wsgi.py&gt;</span><br><span class="line">  Order deny,allow</span><br><span class="line">  Require all granted</span><br><span class="line">&lt;/Files&gt;</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure>
<p>利用WSGIScriptAlias，我们实际上将URL / 对应了wsgi接口程序。这样，当我们访问根URL时，访问请求会经由WSGI接口，传递给Django 项目 mysite。</p>
<p>重启 apache2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/apache2 restart</span><br></pre></td></tr></table></figure>
<p>Ok,现在可以访问到我们的 Django 站点了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/07/31/Kali-Proxy/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/31/Kali-Proxy/" itemprop="url">Kali Proxy</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-07-31T21:24:00+08:00">
                2016-07-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-XXNET"><a href="#0x00-XXNET" class="headerlink" title="0x00 XXNET"></a>0x00 XXNET</h3><p>详细配置可以参考官方文档: <a href="https://github.com/XX-net/XX-Net" target="_blank" rel="noopener">https://github.com/XX-net/XX-Net</a></p>
<h4 id="Google-APPID"><a href="#Google-APPID" class="headerlink" title="Google APPID"></a>Google APPID</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">goagent5-143111|goagent4-143111|goagent3-143111|goagent2-143111|goagent1-143111|goagent-143111</span><br></pre></td></tr></table></figure>
<p>Firefox 需手动导入证书 data/gae_proxy/CA.crt 启动后生成。</p>
<hr>
<h3 id="0x01-ShadowSocks"><a href="#0x01-ShadowSocks" class="headerlink" title="0x01 ShadowSocks"></a>0x01 ShadowSocks</h3><p>删除ShadowSocks本地缓存:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$: cd /root/.config/shadowsocks-gui/Local\ Storage/</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="0x02-Tor"><a href="#0x02-Tor" class="headerlink" title="0x02 Tor"></a>0x02 Tor</h3><h4 id="Kali-tor安装"><a href="#Kali-tor安装" class="headerlink" title="Kali tor安装"></a>Kali tor安装</h4><blockquote>
<p><a href="http://www.blackmoreops.com/2013/12/16/installing-tor-kali-linux/" target="_blank" rel="noopener">http://www.blackmoreops.com/2013/12/16/installing-tor-kali-linux/</a></p>
</blockquote>
<h4 id="Tor官网"><a href="#Tor官网" class="headerlink" title="Tor官网"></a>Tor官网</h4><blockquote>
<p><a href="https://www.torproject.org/download/download-easy.html.en" target="_blank" rel="noopener">https://www.torproject.org/download/download-easy.html.en</a></p>
</blockquote>
<h4 id="暗网wiki"><a href="#暗网wiki" class="headerlink" title="暗网wiki"></a>暗网wiki</h4><blockquote>
<p><a href="http://zqktlwi4fecvo6ri.onion/wiki/index.php/Main.Page" target="_blank" rel="noopener">http://zqktlwi4fecvo6ri.onion/wiki/index.php/Main.Page</a></p>
</blockquote>
<h4 id="kali-下-Tor-启动问题"><a href="#kali-下-Tor-启动问题" class="headerlink" title="kali 下 Tor 启动问题"></a>kali 下 Tor 启动问题</h4><h5 id="should-not-be-run-as-root"><a href="#should-not-be-run-as-root" class="headerlink" title="should not be run as root"></a>should not be run as root</h5><p>解决:<br>在 <code>tor-browser_zh-CN</code> 目录下打开 <code>browser文件夹</code>，选择 <code>start-tor-browser</code> 文件，使用 <code>gedit</code> 打开，（ctrl+f查找root，将{“id -u”-eq 0}中的“0”改为 “1“）。</p>
<h5 id="再次运行出现错误2：“Tor意外退出”："><a href="#再次运行出现错误2：“Tor意外退出”：" class="headerlink" title="再次运行出现错误2：“Tor意外退出”："></a>再次运行出现错误2：“Tor意外退出”：</h5><p>权限问题导致，需将Tor目录的权限改为root账号，chown -R root:root tor-browser_zh_CN</p>
<blockquote>
<p>!Note \<br>最大化tor browser窗口之后，网站可以获取显示器尺寸信息，从而跟踪用户！</p>
</blockquote>
<hr>
<h3 id="0x03-命令行Proxy"><a href="#0x03-命令行Proxy" class="headerlink" title="0x03 命令行Proxy"></a>0x03 命令行Proxy</h3><h4 id="对-apt-get-添加代理设置"><a href="#对-apt-get-添加代理设置" class="headerlink" title="对 apt-get 添加代理设置"></a>对 <code>apt-get</code> 添加代理设置</h4><p>如果使用的是 <code>XX-NET</code> 代理，可在 <code>/etc/apt/apt.conf</code> 文件中添加如下内容:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Acquire::http::Proxy &quot;http://127.0.0.1:8087&quot;;</span><br></pre></td></tr></table></figure>
<p>此外，同样但不限于以下方法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#Acquire::ftp::Proxy&quot;ftp://127.0.0.1:8087&quot;;</span><br><span class="line">#Acquire::https::Proxy&quot;https://127.0.0.1:8087&quot;;</span><br><span class="line">#Acquire::socks::Proxy&quot;https://127.0.0.1:8087&quot;;</span><br></pre></td></tr></table></figure>
<h4 id="添加-export-对不支持Proxy的程序使用代理"><a href="#添加-export-对不支持Proxy的程序使用代理" class="headerlink" title="添加 export 对不支持Proxy的程序使用代理"></a>添加 <code>export</code> 对不支持Proxy的程序使用代理</h4><p>编辑 <code>/etc/bash.bashrc</code> 文件，在末尾添加如下内容:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export http_proxy=&quot;http://127.0.0.1:8087&quot;</span><br></pre></td></tr></table></figure>
<p>使用 <code>curl</code> 命令进行验证</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> root ~ 1 curl -v http://www.sina.com</span><br></pre></td></tr></table></figure>
<h4 id="终极武器-proxychains"><a href="#终极武器-proxychains" class="headerlink" title="终极武器 proxychains"></a>终极武器 <code>proxychains</code></h4><p>以上所有的方法都决定了一次只能使用一个代理，即只会进行一次跳转，使用 <code>proxychains</code> 可以一次实现多次跳转。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> root ~ 1 vim /etc/proxychains.conf</span><br></pre></td></tr></table></figure>
<p><code>proxychains</code> 有三种类型的代理， <code>static</code> , <code>dynamic</code> , <code>random</code>:<br>默认使用 <code>static</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">static: 使用静态代理的方式，按添加代理服务器的地址顺序进行 `串联` 代理，若是其中一个无法连接，则整个代理链无法使用。</span><br><span class="line"></span><br><span class="line">dynamic: 类似static代理，不过使用 `并联` 的方式，当添加的代理链中的某一个代理服务器无法使用时，  将自动跳过该代理服务器。</span><br><span class="line"></span><br><span class="line">random :  随机选择代理链中的所有服务器进行代理。</span><br></pre></td></tr></table></figure></p>
<p>此外，当选择使用 <code>random</code> 代理时，可以指定代理链的长度。不使用默认 DNS 代理设置，以及设置代理连接和超时时间长度等。</p>
<p>设置完毕，当在命令行中使用 <code>proxychains</code> 前缀，便可以对任意程序使用代理链代理了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> root ~ 1 proxychains nmap -p80 211.144.145.0/24</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/07/31/Kali网络配置/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/31/Kali网络配置/" itemprop="url">Kali网络配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-07-31T21:24:00+08:00">
                2016-07-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-Kali-网络配置"><a href="#0x00-Kali-网络配置" class="headerlink" title="0x00 Kali 网络配置"></a>0x00 Kali 网络配置</h3><p>当在一个有DHCP服务器的网络环境中，kali会自动获取到IP地址，如果获取失败则将手动配置网络。</p>
<h4 id="临时ip地址-电脑重启后失效"><a href="#临时ip地址-电脑重启后失效" class="headerlink" title="临时ip地址(电脑重启后失效)"></a>临时ip地址(电脑重启后失效)</h4><p>自动获得ip地址：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dhclient eth0</span><br></pre></td></tr></table></figure>
<p>手动获得ip地址：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ifconfig eth0 192.168.1.10/11</span><br></pre></td></tr></table></figure>
<p>查看网络配置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ifconfig eth0</span><br></pre></td></tr></table></figure>
<p>添加网关:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ route add default gw 192.168.1.1</span><br></pre></td></tr></table></figure>
<p>查看：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ netstat -nr</span><br></pre></td></tr></table></figure>
<p>静态路由的添加并指定网卡:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ route add -net 192.168.0.0/24 gw 192.168.1.100 eth0</span><br></pre></td></tr></table></figure>
<p>编辑DNS:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ echo nameserver 8.8.8.8 &gt; /etc/resolv.conf</span><br></pre></td></tr></table></figure>
<p>重启网卡:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /etc/init.d/networking restart</span><br></pre></td></tr></table></figure>
<p>重启网络管理:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /etc/init.d/network-manager restart</span><br></pre></td></tr></table></figure>
<h4 id="设置固定ip"><a href="#设置固定ip" class="headerlink" title="设置固定ip"></a>设置固定ip</h4><p>编辑网卡配置文件路径:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ vi  /etc/network/interfaces</span><br><span class="line"></span><br><span class="line">    allow hotplug eth0</span><br><span class="line">    iface eth0 inet static</span><br><span class="line">    address 192.168.0.1</span><br><span class="line">    netmask 255.255.255.0</span><br><span class="line">    gateway 192.168.0.254</span><br><span class="line">    dns-nameservers 192.168.0.10 8.8.8.8</span><br><span class="line"></span><br><span class="line">#auto lo</span><br><span class="line">#iface  to  inet loop back</span><br></pre></td></tr></table></figure>
<p>当然也可以安装wicd，它可是比系统自带的<code>network-manager</code>好用多了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ apt-get install wicd</span><br><span class="line">$ /etc/init.d/network-manager stop             //停用network-manager</span><br><span class="line">$ update-rc.d network-manager disable      //禁止network-manager开机启动</span><br><span class="line">$ wicd-client                             //启动wicd</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/07/31/vega/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/31/vega/" itemprop="url">vega</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-07-31T11:16:00+08:00">
                2016-07-31
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-vega简介"><a href="#0x00-vega简介" class="headerlink" title="0x00 vega简介"></a>0x00 vega简介</h3><p>vega是JAVA编写的开源的图形化Web应用检测平台，可以帮助你发现和确认SQL注入、XSS、信息泄漏和其他漏洞，能在Linux, OS X, and Windows上运行。它有两种工作模式，扫描模式(Scanner)和代理模式(Proxy)，可以进行爬站，处理表单和注入测试。</p>
<p>大多数的Web扫描器几乎都是支持主动扫描和代理扫描模式的。</p>
<p>启用代理模式，可以使用代理服务器对提交的数据进行任意修改，这将可以使得我们更方便的了解到整个提交响应的流程。</p>
<p>同时vega也是支持SSL扫描的。</p>
<hr>
<h3 id="0x01-配置扫描模块功能"><a href="#0x01-配置扫描模块功能" class="headerlink" title="0x01 配置扫描模块功能"></a>0x01 配置扫描模块功能</h3><p><img src="http://upload-images.jianshu.io/upload_images/1571420-63f5a83639f8edf3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="2016-09-02 23-30-47 的屏幕截图.png"></p>
<ul>
<li><p>Injection Modules:<br>该模块下包含一些常用的，比如，sql盲注，XSS跨站脚本，XML注入检查，Http头注入啦等等</p>
</li>
<li><p>Response Processing Modules:<br>响应进程模块。</p>
</li>
</ul>
<h4 id="Edit-Target-Scope"><a href="#Edit-Target-Scope" class="headerlink" title="Edit Target Scope"></a>Edit Target Scope</h4><p>将要扫描的目标划分为一个集合，就是将多个站点作为一个租进行统一的扫描；同时也可以设置不扫描的url页面。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-52d5e4c47131ed39.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Edit Target Scope.png"></p>
<hr>
<h3 id="0x02-Proxy模式"><a href="#0x02-Proxy模式" class="headerlink" title="0x02 Proxy模式"></a>0x02 Proxy模式</h3><p>首先打开vega，打开vega的Proxy模式，并选择windows菜单下的Preferences选项对其进行基本配置。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-2d06d90b76eb1e60.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Proxy-Windows-Preferences.png"></p>
<p>打开页面可以看到左边可以进行三项不同和的配置:</p>
<h4 id="General"><a href="#General" class="headerlink" title="General"></a>General</h4><p>在General下可以设置vega的两种外部代理模式，SOCKS proxy（Tor 代理）和External HTPP proxy(Agent 代理)，以此所有vega发起的请求便都会经过这个两个中的一个进行转发了。</p>
<p>然后<code>Appearence</code>选择界面显示style，<code>Updates</code>可以选项vega自动更新。</p>
<h4 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h4><p>该<code>Proxy</code>表示的是vega的内部代理，可以将vega伪造成为某个特定类型的浏览器。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-18cf623bd5079a9b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Proxy-Windows-Preferences-Proxy.png"></p>
<ul>
<li><p>Override client User-Agent<br>代表使用上面的Defaul User-Agent的字符去覆盖客户端的浏览器代理。</p>
</li>
<li><p>Prevent browser caching<br>阻止浏览器缓存。以此可以每次都发起一个全新的请求，建议勾选。</p>
</li>
<li><p>Prevent intermediate caching<br>阻止中间代理服务器缓存。作用同上。</p>
</li>
</ul>
<h5 id="Listener"><a href="#Listener" class="headerlink" title="Listener"></a>Listener</h5><p>选择vega的Proxy模式，以为着vega本身便是一个代理软件了，这时可以在Proxy下的Litener下设置要监听的IP地址和端口好了。</p>
<h4 id="Scanner"><a href="#Scanner" class="headerlink" title="Scanner"></a>Scanner</h4><ul>
<li>total path descendants: 最大扫描路径</li>
<li>child paths for a single node: 单个节点下的最大扫描子路劲</li>
<li>path depth:扫描的超链接数量</li>
<li>duplicate path elements:多个路径的枚举数</li>
<li>display in alert reports:在报警报告里显示的最大字符串长度</li>
<li>requests per second to send:每秒发送的最大请求数</li>
<li>response size to process in kilobytes:</li>
</ul>
<h5 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h5><ul>
<li>记录所有的Scanner请求</li>
<li>将调试信息输出到控制台</li>
</ul>
<blockquote>
<p>proxy模式下，Listerner是必须要设置的。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# netstat -pantu | grep 1080</span><br><span class="line">tcp6       0      0 127.0.0.1:1080          :::*                    LISTEN      2962/java</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="Proxy模式实战"><a href="#Proxy模式实战" class="headerlink" title="Proxy模式实战"></a>Proxy模式实战</h4><h5 id="设置Vega监听"><a href="#设置Vega监听" class="headerlink" title="设置Vega监听"></a>设置Vega监听</h5><p>当配置好Vega代理模式以后，便可以通过浏览器去访问目标网站了，当然还需要对浏览器进行代理设置并保证浏览器中代理设置与vega-&gt;Perference-&gt;Proxy-&gt;Listener下的代理设置保持一致。</p>
<p>首先设置vega代理:<br>其实，这里主要设置vega要监听的代理主机的IP和port，可以是局域网下的host，也可以外网的host，这样可以让vega成为一个Proxy服务器，这与vega-&gt;Perference-&gt;General下的Proxy是完全不同的。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-177ca58936fe4dec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="vega-&gt;Perference-&gt;Proxy-&gt;Listener.png"></p>
<h5 id="设置firefox代理"><a href="#设置firefox代理" class="headerlink" title="设置firefox代理"></a>设置firefox代理</h5><p>然后打开firefox，设置AutoProxy中的代理参数:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-dbafc2fdc516fd34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="设置fireproxy使用vega代理.png"></p>
<p>模式代理服务器使用vega，并开启全局代理，这样所有的流量都将会经过代理服务器。</p>
<p>所有参数设置完毕，在vega中选择<code>start HTTP Proxy</code>，然后通过浏览器访问目标完整，那么所有的数据都将会被vega记录下来：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-a0ce580317a28a01.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="使用vega代理爬取sina.png"></p>
<h5 id="遨游目标网站"><a href="#遨游目标网站" class="headerlink" title="遨游目标网站"></a>遨游目标网站</h5><p>浏览网站，发现目标服务器所有可能的数据交互的地方，比如表单，登陆，注册页面等。</p>
<h5 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h5><p>目标网站手动浏览完成以后，便可以被动的对爬取下来的网站经行漏洞检测了，只需点击Scanner选项就可以了:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-eeee187611023f6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Proxy下Scanner结果.png"></p>
<p>从上可以得到：针对192.168.234.129/dvwa/，一共发现了三个高危，一共中级，一个低级漏洞。</p>
<p>当然，这只是下vega的Proxy模式下，在被动扫描得到的结果，下面来看看vega强大的<code>Scanner</code>模式。</p>
<hr>
<h3 id="0x03-Scanner模式"><a href="#0x03-Scanner模式" class="headerlink" title="0x03 Scanner模式"></a>0x03 Scanner模式</h3><p>Vega的Scanner模式，又代表了vega下的主动扫描，<br>首先选择vega下的Scanner模式:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-0fdd7f264748082f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Scanner模式.png"></p>
<p>点击导航栏上的<code>scan</code>选项，选择<code>start new scan</code>(开始个新的扫描)或者<code>Edit Target Scope</code>(编辑一个扫描组合)</p>
<hr>
<h4 id="Edit-Target-Scope-amp-amp-Start-new-scan"><a href="#Edit-Target-Scope-amp-amp-Start-new-scan" class="headerlink" title="Edit Target Scope &amp;&amp; Start new scan"></a>Edit Target Scope &amp;&amp; Start new scan</h4><p>我们先<code>Edit Target Scope</code>，在该配置下可设定目标的扫描根路径，并且排除不需要扫描的网站页面。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-db39dbdb0f9a0926.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Edit Target Scope.png"></p>
<p>设置完成，开始<code>Start new scan</code>，并且<code>Choose a target scope for scan</code>，就是刚刚配置的scope了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-70dd7837e77130c2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Start new scam.png"></p>
<h4 id="配置cookie或者登陆验证"><a href="#配置cookie或者登陆验证" class="headerlink" title="配置cookie或者登陆验证"></a>配置cookie或者登陆验证</h4><p>当一个网站需要登陆凭证才可以访问的时候，通常会使用cookies进行填充，而cookie可以从浏览器获得或者使用抓包工具去抓取。当然也可以直接设置验证参数。</p>
<p>在vega里面可以直接设置验证参数:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-a684ef5d23f90864.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Identity.png"></p>
<p>前三种，basic http authentication,digest http authentication,NTLM,都是基于web server来进行的登陆验证模式，而Macro(宏)则是针对web application表单提交式的登陆验证模式，这也是当前比较主流的方式:</p>
<p>输入Identity:name:name<br>选择验证类型:Macro</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-185d5c265690ed58.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SetIdentity.png"></p>
<p>create macro:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-844e4950e86e6bfc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Create Macro.png"></p>
<p>add item:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-3c8fc82500068d54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="add Item.png"></p>
<p>选择拥有登录cookie信息的requset页面，即是login.php页面作为验证参数页面:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-51cc0fb0f374d3f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Selecte Login.php.png ]
"></p>
<p>注意选择完毕要双击该<code>url</code>，出现如下页面，勾选Configuration下的两个选项:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-11a6b185f03742cb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Configuration.png"></p>
<hr>
<h4 id="Start-New-Scope"><a href="#Start-New-Scope" class="headerlink" title="Start New Scope"></a>Start New Scope</h4><p>ok,身份信息设置完毕。直接开始<code>Scanner</code>-&gt;<code>Start New Scan</code>，选择之前设置好的Dvwa Scope :</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-b4fa61c16c259189.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Scanner-&gt;Satrt New Scope-&gt;Choose Scope.png"></p>
<p>next,Select Modules:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-b429838c18ed6e6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Select Modules.png"></p>
<p>在Authentication Options中选择之前设置好的admin验证信息:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-1b3beb2016b01f54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Authentication.png"></p>
<p>vega自动扫描开始:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-09c151709008a962.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Scanning.png"></p>
<p>等待扫描完成，得到扫描报告：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-b0be52c232a9b9cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Get Scanner Report.png"></p>
<p>从最后的扫报告可以看到，vega的scanner(主动扫描)比Proxy下的被动扫描发现的漏洞要多得多。</p>
<p>对于漏洞的具体利用，将在以后讲到。</p>
<hr>
<h3 id="0x04-vega后续使用优化"><a href="#0x04-vega后续使用优化" class="headerlink" title="0x04 vega后续使用优化"></a>0x04 vega后续使用优化</h3><h5 id="Filter-by-scope"><a href="#Filter-by-scope" class="headerlink" title="Filter by scope"></a>Filter by scope</h5><p>在<code>Website View</code>界面下，选择<code>Filter By Scope</code>可以过滤掉目标网站里嵌套的超链，从而排除其它不必要的感染。</p>
<hr>
<h3 id="0x05-手动Debug"><a href="#0x05-手动Debug" class="headerlink" title="0x05 手动Debug"></a>0x05 手动Debug</h3><p>可以在Proxy模式下，选择某一个url页面，然后右键<code>Replay Request</code>进行重放。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-ace088cde801933f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Replay Request.png"></p>
<hr>
<h3 id="0x06-Vega的-Intercept-截断功能"><a href="#0x06-Vega的-Intercept-截断功能" class="headerlink" title="0x06 Vega的(Intercept)截断功能"></a>0x06 Vega的(Intercept)截断功能</h3><p>截断的意思，就是当client通过proxy向server发起request的时候，proxy会截断request，在修改该request后在向server发送,当然proxy也可以intercept server 给client的response，进行修改和篡改。</p>
<p>实验过程中，vega对数据的重放和截断还有所欠缺。</p>
<hr>
<h3 id="0x07-Vega-访问-Hppts网站"><a href="#0x07-Vega-访问-Hppts网站" class="headerlink" title="0x07 Vega 访问 Hppts网站"></a>0x07 Vega 访问 Hppts网站</h3><p>Https网站是通过证书加密了的，国内比如百度，据说已经采用了https全站加密。</p>
<p>所有，当使用了vega代理模式，并且访问https网站时，可以访问HTTP://vega/ca.crt，只用vega的字签名证书，添加该网站为可信任站点。</p>
<p>问题:关于https的传输和加密过程？</p>
<hr>
<p>title: vega<br>date: 2016-07-31 11:16<br>tags: [‘Kali渗透测试’,’Web渗透测试’]<br>toc: true<br>categories: technology</p>
<hr>
<h3 id="0x00-vega简介-1"><a href="#0x00-vega简介-1" class="headerlink" title="0x00 vega简介"></a>0x00 vega简介</h3><p>vega是一个基于Java编写的开源可视化Web扫描器。</p>
<hr>
<h3 id="0x01-配置扫描模块功能-1"><a href="#0x01-配置扫描模块功能-1" class="headerlink" title="0x01 配置扫描模块功能"></a>0x01 配置扫描模块功能</h3><p><img src="http://upload-images.jianshu.io/upload_images/1571420-63f5a83639f8edf3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="2016-09-02 23-30-47 的屏幕截图.png"></p>
<ul>
<li><p>Injection Modules:<br>该模块下包含一些常用的，比如，sql盲注，XSS跨站脚本，XML注入检查，Http头注入啦等等</p>
</li>
<li><p>Response Processing Modules:<br>响应进程模块。</p>
</li>
</ul>
<h4 id="Edit-Target-Scope-1"><a href="#Edit-Target-Scope-1" class="headerlink" title="Edit Target Scope"></a>Edit Target Scope</h4><p>将要扫描的目标划分为一个集合，就是将多个站点作为一个租进行统一的扫描；同时也可以设置不扫描的url页面。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-52d5e4c47131ed39.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Edit Target Scope.png"></p>
<hr>
<h3 id="0x02-Proxy模式-1"><a href="#0x02-Proxy模式-1" class="headerlink" title="0x02 Proxy模式"></a>0x02 Proxy模式</h3><p>首先打开vega，打开vega的Proxy模式，并选择windows菜单下的Preferences选项对其进行基本配置。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-2d06d90b76eb1e60.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Proxy-Windows-Preferences.png"></p>
<p>打开页面可以看到左边可以进行三项不同和的配置:</p>
<h4 id="General-1"><a href="#General-1" class="headerlink" title="General"></a>General</h4><p>在General下可以设置vega的两种外部代理模式，SOCKS proxy（Tor 代理）和External HTPP proxy(Agent 代理)，以此所有vega发起的请求便都会经过这个两个中的一个进行转发了。</p>
<p>然后<code>Appearence</code>选择界面显示style，<code>Updates</code>可以选项vega自动更新。</p>
<h4 id="Proxy-1"><a href="#Proxy-1" class="headerlink" title="Proxy"></a>Proxy</h4><p>该<code>Proxy</code>表示的是vega的内部代理，可以将vega伪造成为某个特定类型的浏览器。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-18cf623bd5079a9b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Proxy-Windows-Preferences-Proxy.png"></p>
<ul>
<li><p>Override client User-Agent<br>代表使用上面的Defaul User-Agent的字符去覆盖客户端的浏览器代理。</p>
</li>
<li><p>Prevent browser caching<br>阻止浏览器缓存。以此可以每次都发起一个全新的请求，建议勾选。</p>
</li>
<li><p>Prevent intermediate caching<br>阻止中间代理服务器缓存。作用同上。</p>
</li>
</ul>
<h5 id="Listener-1"><a href="#Listener-1" class="headerlink" title="Listener"></a>Listener</h5><p>选择vega的Proxy模式，以为着vega本身便是一个代理软件了，这时可以在Proxy下的Litener下设置要监听的IP地址和端口好了。</p>
<h4 id="Scanner-1"><a href="#Scanner-1" class="headerlink" title="Scanner"></a>Scanner</h4><ul>
<li>total path descendants: 最大扫描路径</li>
<li>child paths for a single node: 单个节点下的最大扫描子路劲</li>
<li>path depth:扫描的超链接数量</li>
<li>duplicate path elements:多个路径的枚举数</li>
<li>display in alert reports:在报警报告里显示的最大字符串长度</li>
<li>requests per second to send:每秒发送的最大请求数</li>
<li>response size to process in kilobytes:</li>
</ul>
<h5 id="Debug-1"><a href="#Debug-1" class="headerlink" title="Debug"></a>Debug</h5><ul>
<li>记录所有的Scanner请求</li>
<li>将调试信息输出到控制台</li>
</ul>
<blockquote>
<p>proxy模式下，Listerner是必须要设置的。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# netstat -pantu | grep 1080</span><br><span class="line">tcp6       0      0 127.0.0.1:1080          :::*                    LISTEN      2962/java</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="Proxy模式实战-1"><a href="#Proxy模式实战-1" class="headerlink" title="Proxy模式实战"></a>Proxy模式实战</h4><h5 id="设置Vega监听-1"><a href="#设置Vega监听-1" class="headerlink" title="设置Vega监听"></a>设置Vega监听</h5><p>当配置好Vega代理模式以后，便可以通过浏览器去访问目标网站了，当然还需要对浏览器进行代理设置并保证浏览器中代理设置与vega-&gt;Perference-&gt;Proxy-&gt;Listener下的代理设置保持一致。</p>
<p>首先设置vega代理:<br>其实，这里主要设置vega要监听的代理主机的IP和port，可以是局域网下的host，也可以外网的host，这样可以让vega成为一个Proxy服务器，这与vega-&gt;Perference-&gt;General下的Proxy是完全不同的。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-177ca58936fe4dec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="vega-&gt;Perference-&gt;Proxy-&gt;Listener.png"></p>
<h5 id="设置firefox代理-1"><a href="#设置firefox代理-1" class="headerlink" title="设置firefox代理"></a>设置firefox代理</h5><p>然后打开firefox，设置AutoProxy中的代理参数:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-dbafc2fdc516fd34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="设置fireproxy使用vega代理.png"></p>
<p>模式代理服务器使用vega，并开启全局代理，这样所有的流量都将会经过代理服务器。</p>
<p>所有参数设置完毕，在vega中选择<code>start HTTP Proxy</code>，然后通过浏览器访问目标完整，那么所有的数据都将会被vega记录下来：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-a0ce580317a28a01.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="使用vega代理爬取sina.png"></p>
<h5 id="遨游目标网站-1"><a href="#遨游目标网站-1" class="headerlink" title="遨游目标网站"></a>遨游目标网站</h5><p>浏览网站，发现目标服务器所有可能的数据交互的地方，比如表单，登陆，注册页面等。</p>
<h5 id="漏洞检测-1"><a href="#漏洞检测-1" class="headerlink" title="漏洞检测"></a>漏洞检测</h5><p>目标网站手动浏览完成以后，便可以被动的对爬取下来的网站经行漏洞检测了，只需点击Scanner选项就可以了:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-eeee187611023f6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Proxy下Scanner结果.png"></p>
<p>从上可以得到：针对192.168.234.129/dvwa/，一共发现了三个高危，一共中级，一个低级漏洞。</p>
<p>当然，这只是下vega的Proxy模式下，在被动扫描得到的结果，下面来看看vega强大的<code>Scanner</code>模式。</p>
<hr>
<h3 id="0x03-Scanner模式-1"><a href="#0x03-Scanner模式-1" class="headerlink" title="0x03 Scanner模式"></a>0x03 Scanner模式</h3><p>Vega的Scanner模式，又代表了vega下的主动扫描，<br>首先选择vega下的Scanner模式:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-0fdd7f264748082f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Scanner模式.png"></p>
<p>点击导航栏上的<code>scan</code>选项，选择<code>start new scan</code>(开始个新的扫描)或者<code>Edit Target Scope</code>(编辑一个扫描组合)</p>
<hr>
<h4 id="Edit-Target-Scope-amp-amp-Start-new-scan-1"><a href="#Edit-Target-Scope-amp-amp-Start-new-scan-1" class="headerlink" title="Edit Target Scope &amp;&amp; Start new scan"></a>Edit Target Scope &amp;&amp; Start new scan</h4><p>我们先<code>Edit Target Scope</code>，在该配置下可设定目标的扫描根路径，并且排除不需要扫描的网站页面。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-db39dbdb0f9a0926.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Edit Target Scope.png"></p>
<p>设置完成，开始<code>Start new scan</code>，并且<code>Choose a target scope for scan</code>，就是刚刚配置的scope了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-70dd7837e77130c2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Start new scam.png"></p>
<h4 id="配置cookie或者登陆验证-1"><a href="#配置cookie或者登陆验证-1" class="headerlink" title="配置cookie或者登陆验证"></a>配置cookie或者登陆验证</h4><p>当一个网站需要登陆凭证才可以访问的时候，通常会使用cookies进行填充，而cookie可以从浏览器获得或者使用抓包工具去抓取。当然也可以直接设置验证参数。</p>
<p>在vega里面可以直接设置验证参数:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-a684ef5d23f90864.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Identity.png"></p>
<p>前三种，basic http authentication,digest http authentication,NTLM,都是基于web server来进行的登陆验证模式，而Macro(宏)则是针对web application表单提交式的登陆验证模式，这也是当前比较主流的方式:</p>
<p>输入Identity:name:name<br>选择验证类型:Macro</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-185d5c265690ed58.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SetIdentity.png"></p>
<p>create macro:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-844e4950e86e6bfc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Create Macro.png"></p>
<p>add item:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-3c8fc82500068d54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="add Item.png"></p>
<p>选择拥有登录cookie信息的requset页面，即是login.php页面作为验证参数页面:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-51cc0fb0f374d3f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Selecte Login.php.png ]
"></p>
<p>注意选择完毕要双击该<code>url</code>，出现如下页面，勾选Configuration下的两个选项:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-11a6b185f03742cb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Configuration.png"></p>
<hr>
<h4 id="Start-New-Scope-1"><a href="#Start-New-Scope-1" class="headerlink" title="Start New Scope"></a>Start New Scope</h4><p>ok,身份信息设置完毕。直接开始<code>Scanner</code>-&gt;<code>Start New Scan</code>，选择之前设置好的Dvwa Scope :</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-b4fa61c16c259189.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Scanner-&gt;Satrt New Scope-&gt;Choose Scope.png"></p>
<p>next,Select Modules:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-b429838c18ed6e6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Select Modules.png"></p>
<p>在Authentication Options中选择之前设置好的admin验证信息:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-1b3beb2016b01f54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Authentication.png"></p>
<p>vega自动扫描开始:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-09c151709008a962.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Scanning.png"></p>
<p>等待扫描完成，得到扫描报告：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-b0be52c232a9b9cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Get Scanner Report.png"></p>
<p>从最后的扫报告可以看到，vega的scanner(主动扫描)比Proxy下的被动扫描发现的漏洞要多得多。</p>
<p>对于漏洞的具体利用，将在以后讲到。</p>
<hr>
<h3 id="0x04-vega后续使用优化-1"><a href="#0x04-vega后续使用优化-1" class="headerlink" title="0x04 vega后续使用优化"></a>0x04 vega后续使用优化</h3><h5 id="Filter-by-scope-1"><a href="#Filter-by-scope-1" class="headerlink" title="Filter by scope"></a>Filter by scope</h5><p>在<code>Website View</code>界面下，选择<code>Filter By Scope</code>可以过滤掉目标网站里嵌套的超链，从而排除其它不必要的感染。</p>
<hr>
<h3 id="0x05-手动Debug-1"><a href="#0x05-手动Debug-1" class="headerlink" title="0x05 手动Debug"></a>0x05 手动Debug</h3><p>可以在Proxy模式下，选择某一个url页面，然后右键<code>Replay Request</code>进行重放。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-ace088cde801933f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Replay Request.png"></p>
<hr>
<h3 id="0x06-Vega的-Intercept-截断功能-1"><a href="#0x06-Vega的-Intercept-截断功能-1" class="headerlink" title="0x06 Vega的(Intercept)截断功能"></a>0x06 Vega的(Intercept)截断功能</h3><p>截断的意思，就是当client通过proxy向server发起request的时候，proxy会截断request，在修改该request后在向server发送,当然proxy也可以intercept server 给client的response，进行修改和篡改。</p>
<p>实验过程中，vega对数据的重放和截断还有所欠缺。</p>
<hr>
<h3 id="0x07-Vega-访问-Hppts网站-1"><a href="#0x07-Vega-访问-Hppts网站-1" class="headerlink" title="0x07 Vega 访问 Hppts网站"></a>0x07 Vega 访问 Hppts网站</h3><p>Https网站是通过证书加密了的，国内比如百度，据说已经采用了https全站加密。</p>
<p>所有，当使用了vega代理模式，并且访问https网站时，可以访问HTTP://vega/ca.crt，只用vega的字签名证书，添加该网站为可信任站点。</p>
<p>问题:关于https的传输和加密过程？</p>
<hr>
<p>title: vega<br>date: 2016-07-31 11:16<br>tags: [‘Kali渗透测试’,’Web渗透测试’]<br>toc: true<br>categories: technology</p>
<hr>
<h3 id="0x00-vega简介-2"><a href="#0x00-vega简介-2" class="headerlink" title="0x00 vega简介"></a>0x00 vega简介</h3><p>vega是一个基于Java编写的开源可视化Web扫描器。</p>
<hr>
<h3 id="0x01-配置扫描模块功能-2"><a href="#0x01-配置扫描模块功能-2" class="headerlink" title="0x01 配置扫描模块功能"></a>0x01 配置扫描模块功能</h3><p><img src="http://upload-images.jianshu.io/upload_images/1571420-63f5a83639f8edf3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="2016-09-02 23-30-47 的屏幕截图.png"></p>
<ul>
<li><p>Injection Modules:<br>该模块下包含一些常用的，比如，sql盲注，XSS跨站脚本，XML注入检查，Http头注入啦等等</p>
</li>
<li><p>Response Processing Modules:<br>响应进程模块。</p>
</li>
</ul>
<h4 id="Edit-Target-Scope-2"><a href="#Edit-Target-Scope-2" class="headerlink" title="Edit Target Scope"></a>Edit Target Scope</h4><p>将要扫描的目标划分为一个集合，就是将多个站点作为一个租进行统一的扫描；同时也可以设置不扫描的url页面。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-52d5e4c47131ed39.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Edit Target Scope.png"></p>
<hr>
<h3 id="0x02-Proxy模式-2"><a href="#0x02-Proxy模式-2" class="headerlink" title="0x02 Proxy模式"></a>0x02 Proxy模式</h3><p>首先打开vega，打开vega的Proxy模式，并选择windows菜单下的Preferences选项对其进行基本配置。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-2d06d90b76eb1e60.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Proxy-Windows-Preferences.png"></p>
<p>打开页面可以看到左边可以进行三项不同和的配置:</p>
<h4 id="General-2"><a href="#General-2" class="headerlink" title="General"></a>General</h4><p>在General下可以设置vega的两种外部代理模式，SOCKS proxy（Tor 代理）和External HTPP proxy(Agent 代理)，以此所有vega发起的请求便都会经过这个两个中的一个进行转发了。</p>
<p>然后<code>Appearence</code>选择界面显示style，<code>Updates</code>可以选项vega自动更新。</p>
<h4 id="Proxy-2"><a href="#Proxy-2" class="headerlink" title="Proxy"></a>Proxy</h4><p>该<code>Proxy</code>表示的是vega的内部代理，可以将vega伪造成为某个特定类型的浏览器。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-18cf623bd5079a9b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Proxy-Windows-Preferences-Proxy.png"></p>
<ul>
<li><p>Override client User-Agent<br>代表使用上面的Defaul User-Agent的字符去覆盖客户端的浏览器代理。</p>
</li>
<li><p>Prevent browser caching<br>阻止浏览器缓存。以此可以每次都发起一个全新的请求，建议勾选。</p>
</li>
<li><p>Prevent intermediate caching<br>阻止中间代理服务器缓存。作用同上。</p>
</li>
</ul>
<h5 id="Listener-2"><a href="#Listener-2" class="headerlink" title="Listener"></a>Listener</h5><p>选择vega的Proxy模式，以为着vega本身便是一个代理软件了，这时可以在Proxy下的Litener下设置要监听的IP地址和端口好了。</p>
<h4 id="Scanner-2"><a href="#Scanner-2" class="headerlink" title="Scanner"></a>Scanner</h4><ul>
<li>total path descendants: 最大扫描路径</li>
<li>child paths for a single node: 单个节点下的最大扫描子路劲</li>
<li>path depth:扫描的超链接数量</li>
<li>duplicate path elements:多个路径的枚举数</li>
<li>display in alert reports:在报警报告里显示的最大字符串长度</li>
<li>requests per second to send:每秒发送的最大请求数</li>
<li>response size to process in kilobytes:</li>
</ul>
<h5 id="Debug-2"><a href="#Debug-2" class="headerlink" title="Debug"></a>Debug</h5><ul>
<li>记录所有的Scanner请求</li>
<li>将调试信息输出到控制台</li>
</ul>
<blockquote>
<p>proxy模式下，Listerner是必须要设置的。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# netstat -pantu | grep 1080</span><br><span class="line">tcp6       0      0 127.0.0.1:1080          :::*                    LISTEN      2962/java</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="Proxy模式实战-2"><a href="#Proxy模式实战-2" class="headerlink" title="Proxy模式实战"></a>Proxy模式实战</h4><h5 id="设置Vega监听-2"><a href="#设置Vega监听-2" class="headerlink" title="设置Vega监听"></a>设置Vega监听</h5><p>当配置好Vega代理模式以后，便可以通过浏览器去访问目标网站了，当然还需要对浏览器进行代理设置并保证浏览器中代理设置与vega-&gt;Perference-&gt;Proxy-&gt;Listener下的代理设置保持一致。</p>
<p>首先设置vega代理:<br>其实，这里主要设置vega要监听的代理主机的IP和port，可以是局域网下的host，也可以外网的host，这样可以让vega成为一个Proxy服务器，这与vega-&gt;Perference-&gt;General下的Proxy是完全不同的。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-177ca58936fe4dec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="vega-&gt;Perference-&gt;Proxy-&gt;Listener.png"></p>
<h5 id="设置firefox代理-2"><a href="#设置firefox代理-2" class="headerlink" title="设置firefox代理"></a>设置firefox代理</h5><p>然后打开firefox，设置AutoProxy中的代理参数:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-dbafc2fdc516fd34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="设置fireproxy使用vega代理.png"></p>
<p>模式代理服务器使用vega，并开启全局代理，这样所有的流量都将会经过代理服务器。</p>
<p>所有参数设置完毕，在vega中选择<code>start HTTP Proxy</code>，然后通过浏览器访问目标完整，那么所有的数据都将会被vega记录下来：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-a0ce580317a28a01.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="使用vega代理爬取sina.png"></p>
<h5 id="遨游目标网站-2"><a href="#遨游目标网站-2" class="headerlink" title="遨游目标网站"></a>遨游目标网站</h5><p>浏览网站，发现目标服务器所有可能的数据交互的地方，比如表单，登陆，注册页面等。</p>
<h5 id="漏洞检测-2"><a href="#漏洞检测-2" class="headerlink" title="漏洞检测"></a>漏洞检测</h5><p>目标网站手动浏览完成以后，便可以被动的对爬取下来的网站经行漏洞检测了，只需点击Scanner选项就可以了:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-eeee187611023f6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Proxy下Scanner结果.png"></p>
<p>从上可以得到：针对192.168.234.129/dvwa/，一共发现了三个高危，一共中级，一个低级漏洞。</p>
<p>当然，这只是下vega的Proxy模式下，在被动扫描得到的结果，下面来看看vega强大的<code>Scanner</code>模式。</p>
<hr>
<h3 id="0x03-Scanner模式-2"><a href="#0x03-Scanner模式-2" class="headerlink" title="0x03 Scanner模式"></a>0x03 Scanner模式</h3><p>Vega的Scanner模式，又代表了vega下的主动扫描，<br>首先选择vega下的Scanner模式:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-0fdd7f264748082f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Scanner模式.png"></p>
<p>点击导航栏上的<code>scan</code>选项，选择<code>start new scan</code>(开始个新的扫描)或者<code>Edit Target Scope</code>(编辑一个扫描组合)</p>
<hr>
<h4 id="Edit-Target-Scope-amp-amp-Start-new-scan-2"><a href="#Edit-Target-Scope-amp-amp-Start-new-scan-2" class="headerlink" title="Edit Target Scope &amp;&amp; Start new scan"></a>Edit Target Scope &amp;&amp; Start new scan</h4><p>我们先<code>Edit Target Scope</code>，在该配置下可设定目标的扫描根路径，并且排除不需要扫描的网站页面。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-db39dbdb0f9a0926.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Edit Target Scope.png"></p>
<p>设置完成，开始<code>Start new scan</code>，并且<code>Choose a target scope for scan</code>，就是刚刚配置的scope了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-70dd7837e77130c2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Start new scam.png"></p>
<h4 id="配置cookie或者登陆验证-2"><a href="#配置cookie或者登陆验证-2" class="headerlink" title="配置cookie或者登陆验证"></a>配置cookie或者登陆验证</h4><p>当一个网站需要登陆凭证才可以访问的时候，通常会使用cookies进行填充，而cookie可以从浏览器获得或者使用抓包工具去抓取。当然也可以直接设置验证参数。</p>
<p>在vega里面可以直接设置验证参数:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-a684ef5d23f90864.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Identity.png"></p>
<p>前三种，basic http authentication,digest http authentication,NTLM,都是基于web server来进行的登陆验证模式，而Macro(宏)则是针对web application表单提交式的登陆验证模式，这也是当前比较主流的方式:</p>
<p>输入Identity:name:name<br>选择验证类型:Macro</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-185d5c265690ed58.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SetIdentity.png"></p>
<p>create macro:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-844e4950e86e6bfc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Create Macro.png"></p>
<p>add item:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-3c8fc82500068d54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="add Item.png"></p>
<p>选择拥有登录cookie信息的requset页面，即是login.php页面作为验证参数页面:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-51cc0fb0f374d3f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Selecte Login.php.png ]
"></p>
<p>注意选择完毕要双击该<code>url</code>，出现如下页面，勾选Configuration下的两个选项:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-11a6b185f03742cb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Configuration.png"></p>
<hr>
<h4 id="Start-New-Scope-2"><a href="#Start-New-Scope-2" class="headerlink" title="Start New Scope"></a>Start New Scope</h4><p>ok,身份信息设置完毕。直接开始<code>Scanner</code>-&gt;<code>Start New Scan</code>，选择之前设置好的Dvwa Scope :</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-b4fa61c16c259189.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Scanner-&gt;Satrt New Scope-&gt;Choose Scope.png"></p>
<p>next,Select Modules:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-b429838c18ed6e6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Select Modules.png"></p>
<p>在Authentication Options中选择之前设置好的admin验证信息:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-1b3beb2016b01f54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Authentication.png"></p>
<p>vega自动扫描开始:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-09c151709008a962.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Scanning.png"></p>
<p>等待扫描完成，得到扫描报告：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-b0be52c232a9b9cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Get Scanner Report.png"></p>
<p>从最后的扫报告可以看到，vega的scanner(主动扫描)比Proxy下的被动扫描发现的漏洞要多得多。</p>
<p>对于漏洞的具体利用，将在以后讲到。</p>
<hr>
<h3 id="0x04-vega后续使用优化-2"><a href="#0x04-vega后续使用优化-2" class="headerlink" title="0x04 vega后续使用优化"></a>0x04 vega后续使用优化</h3><h5 id="Filter-by-scope-2"><a href="#Filter-by-scope-2" class="headerlink" title="Filter by scope"></a>Filter by scope</h5><p>在<code>Website View</code>界面下，选择<code>Filter By Scope</code>可以过滤掉目标网站里嵌套的超链，从而排除其它不必要的感染。</p>
<hr>
<h3 id="0x05-手动Debug-2"><a href="#0x05-手动Debug-2" class="headerlink" title="0x05 手动Debug"></a>0x05 手动Debug</h3><p>可以在Proxy模式下，选择某一个url页面，然后右键<code>Replay Request</code>进行重放。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-ace088cde801933f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Replay Request.png"></p>
<hr>
<h3 id="0x06-Vega的-Intercept-截断功能-2"><a href="#0x06-Vega的-Intercept-截断功能-2" class="headerlink" title="0x06 Vega的(Intercept)截断功能"></a>0x06 Vega的(Intercept)截断功能</h3><p>截断的意思，就是当client通过proxy向server发起request的时候，proxy会截断request，在修改该request后在向server发送,当然proxy也可以intercept server 给client的response，进行修改和篡改。</p>
<p>实验过程中，vega对数据的重放和截断还有所欠缺。</p>
<hr>
<h3 id="0x07-Vega-访问-Hppts网站-2"><a href="#0x07-Vega-访问-Hppts网站-2" class="headerlink" title="0x07 Vega 访问 Hppts网站"></a>0x07 Vega 访问 Hppts网站</h3><p>Https网站是通过证书加密了的，国内比如百度，据说已经采用了https全站加密。</p>
<p>所有，当使用了vega代理模式，并且访问https网站时，可以访问HTTP://vega/ca.crt，使用vega的字签名证书，添加该网站为可信任站点。</p>
<p>问题:关于https的传输和加密过程？</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/20/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><span class="page-number current">21</span><a class="page-number" href="/page/22/">22</a><span class="space">&hellip;</span><a class="page-number" href="/page/33/">33</a><a class="extend next" rel="next" href="/page/22/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">onejustonee</p>
              <p class="site-description motion-element" itemprop="description">onejustone's blog</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">329</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">103</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">onejustonee</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
