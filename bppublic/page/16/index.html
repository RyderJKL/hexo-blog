<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="onejustone&apos;s blog">
<meta property="og:type" content="website">
<meta property="og:title" content="onejustone">
<meta property="og:url" content="http://yoursite.com/page/16/index.html">
<meta property="og:site_name" content="onejustone">
<meta property="og:description" content="onejustone&apos;s blog">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="onejustone">
<meta name="twitter:description" content="onejustone&apos;s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/16/">





  <title>onejustone</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">onejustone</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">--愿你内心有种不灭的火焰，将你与别人区分开来--</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/02/4.获取节点的内容/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/02/4.获取节点的内容/" itemprop="url">JS-DOM(4)获取节点的内容</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-02T00:00:00+08:00">
                2016-11-02
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-innerHTML-属性"><a href="#0x00-innerHTML-属性" class="headerlink" title="0x00 innerHTML 属性"></a>0x00 innerHTML 属性</h3><p>innerHTML 在读模式下，返回与调用元素的所有子节点及其内容(HTML 代码)；在写模式下，innerHTML 会根据指定的值创建新的 DOM 树，然后用这个树<strong>完全替换</strong>调用元素原中的<strong>所有 HTML 内容</strong>。</p>
<blockquote>
<p>如果设置(写)或获取(读)的值仅是文本而没有 HTML 标签，那么 innerHTML 的 结果就是设置或获取纯文本。</p>
</blockquote>
<hr>
<h3 id="0x01-outerHTML-属性"><a href="#0x01-outerHTML-属性" class="headerlink" title="0x01 outerHTML 属性"></a>0x01 outerHTML 属性</h3><p>outerHTML 在读模式下，返回调用它的元素本身及所有子节点的 HTML 内容。在写模式下，会根据指定的 HTML 字符内容创建新的 DOM 子树，然后用这个子树 <strong>完全替换调用的元素(包括其元素本身也会替换)</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// HTML:</span><br><span class="line">// &lt;div id=&quot;container&quot;&gt;&lt;div id=&quot;d&quot;&gt;This is a div.&lt;/div&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">container = document.getElementById(&quot;container&quot;);</span><br><span class="line">d = document.getElementById(&quot;d&quot;);</span><br><span class="line">console.log(container.firstChild.nodeName); // logs &quot;DIV&quot;</span><br><span class="line"></span><br><span class="line">d.outerHTML = &quot;&lt;p&gt;This paragraph replaced the original div.&lt;/p&gt;&quot;;</span><br><span class="line">console.log(container.firstChild.nodeName); // logs &quot;P&quot;</span><br><span class="line"></span><br><span class="line">// id为d的div元素已经不在文档树中(不在页面中显示,但仍然在内存中)</span><br><span class="line">// 新的P元素替换了div元素</span><br></pre></td></tr></table></figure>
<p>但是当该元素是 <form> 表单是，outerHTML 不会对表单元素产生任何变化。</form></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//HTML:</span><br><span class="line">// &lt;form id=&quot;myForm&quot;&gt;&lt;p&gt;this is form&lt;/p&gt;&lt;/form&gt;</span><br><span class="line">var form = document.querySelector(&quot;#myForm&quot;);</span><br><span class="line">form.innerHTML = &lt;p&gt;hello word!&lt;/p&gt;</span><br><span class="line">//form 元素不会被替换</span><br></pre></td></tr></table></figure>
<p>此外,当一个元素因为修改自身的 outerHTML 属性而被替换时，指向该元素的变量仍然指向替换前的元素。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var p = document.getElementsByTagName(&quot;p&quot;)[0];</span><br><span class="line">console.log(p.nodeName); // 显示: &quot;P&quot;</span><br><span class="line">p.outerHTML = &quot;&lt;div&gt;This div replaced a paragraph.&lt;/div&gt;&quot;;</span><br><span class="line">console.log(p.nodeName); // 仍然为: &quot;P&quot;;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="0x02-insertAdjacentHTML-属性"><a href="#0x02-insertAdjacentHTML-属性" class="headerlink" title="0x02 insertAdjacentHTML 属性"></a>0x02 insertAdjacentHTML 属性</h3><p>insertAdjacentHTML() 方法接收两个参数: 插入位置和要插入的 HTML 文本。第一个参数必须是下列值之一。</p>
<ul>
<li>beforebegin: 在当前元素之前插入一个紧邻的同辈元素</li>
<li>afterbegin: 在当前元素之下插入一个新的子元素或者作为第一个子元素插入</li>
<li>beforeend: 在当前元素之下插入一新的子元素或者作为最后一个子元素</li>
<li>afterend: 在当前元素之后插入一个紧邻的同辈元素</li>
</ul>
<hr>
<h3 id="0x03-nodeName-和-nodeValue-属性"><a href="#0x03-nodeName-和-nodeValue-属性" class="headerlink" title="0x03 nodeName 和 nodeValue 属性"></a>0x03 nodeName 和 nodeValue 属性</h3><p>nodeName 属性可以获取节点的名称,与标签名相同，只读。  </p>
<ul>
<li>文本节点的 nodeName 始终是 #text 。</li>
<li>文档节点的 nodeName 始终是 #document 。</li>
</ul>
<p>nodeValue 属性获得规定节点的值。</p>
<ul>
<li>元素节点的 nodeValue 是 undefined 或 null。</li>
<li>文本节点的 nodeValue 是文本本身。</li>
<li>属性节点的 nodeValue 是属性值。 </li>
</ul>
<hr>
<h3 id="0x04-textContent-属性"><a href="#0x04-textContent-属性" class="headerlink" title="0x04 textContent 属性"></a>0x04 textContent 属性</h3><p>设置了 textContent 属性，会删除所有子节点，并被替换为包含指定字符串的一个单独的文本节点。</p>
<p>如果是读模式，那么使用 textContent 属性会得到包括其所有子节点在内的文本内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// HTML:</span><br><span class="line">// &lt;form id=&quot;form&quot;&gt;&lt;p&gt;&lt;label&gt;用户名:&lt;/label&gt;&lt;input id=&quot;userName&quot; name =&quot;userName1&quot;  class=&quot;formInput&quot; type=&quot;text&quot;&gt;&lt;/input&gt;&lt;span&gt;输入不合法,必需是中文&lt;/span&gt;&lt;/p&gt;&lt;/form&gt;</span><br><span class="line">var form = document.querySelector(&quot;#form&quot;);</span><br><span class="line">console.log(form.textContent); </span><br><span class="line">//用户名:输入不合法,必需是中文</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/11/01/碰撞检测/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/01/碰撞检测/" itemprop="url">碰撞检测</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-01T00:00:00+08:00">
                2016-11-01
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-圆形碰撞检测"><a href="#0x00-圆形碰撞检测" class="headerlink" title="0x00 圆形碰撞检测"></a>0x00 圆形碰撞检测</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">	&lt;title&gt;圆形碰撞检测&lt;/title&gt;</span><br><span class="line">	&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">		div&#123;</span><br><span class="line">			height: 50px;</span><br><span class="line">			width: 50px;</span><br><span class="line">			border:2px solid deeppink;</span><br><span class="line">			background: yellowgreen;</span><br><span class="line">			border-radius: 100%;</span><br><span class="line">			position: absolute;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		#ballStatic&#123;</span><br><span class="line">			position: absolute;</span><br><span class="line">			top:200px;</span><br><span class="line">			left: 400px;</span><br><span class="line">			z-index:-1;</span><br><span class="line">		&#125;</span><br><span class="line">	&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;div id=&quot;ballMove&quot;&gt;</span><br><span class="line">		</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">	&lt;div id=&quot;ballStatic&quot;&gt;</span><br><span class="line">		</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">	&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">		var move = document.getElementById(&quot;ballMove&quot;);</span><br><span class="line">		//移动的圆</span><br><span class="line">		var static = document.getElementById(&quot;ballStatic&quot;);</span><br><span class="line">		//被碰撞的圆</span><br><span class="line">		move.onmousedown = function (event)&#123;</span><br><span class="line">			var relatiMouseX = event.clientX - move.offsetLeft;</span><br><span class="line">			//获得鼠标在移动圆中的相对 X 位置</span><br><span class="line">			var relatiMouseY = event.clientY - move.offsetTop;</span><br><span class="line">			// 获得鼠标在移动圆中的相对 Y 位置</span><br><span class="line">			document.documentElement.onmousemove = function (event)&#123;</span><br><span class="line">				var moveRicX = event.clientX - relatiMouseX + move.offsetWidth/2;</span><br><span class="line">				//移动圆的圆心 X 坐标</span><br><span class="line"></span><br><span class="line">				var moveRicY = event.clientY - relatiMouseY + move.offsetHeight/2;</span><br><span class="line">				// 移动圆的圆心 Y 坐标</span><br><span class="line"></span><br><span class="line">				var moveRadial = move.offsetHeight/2;</span><br><span class="line">				// 移动圆的半径</span><br><span class="line">				var staticRadial = static.offsetWidth/2;</span><br><span class="line">				// 被碰撞圆的半径</span><br><span class="line"></span><br><span class="line">				var staticRicX = static.offsetLeft + static.offsetWidth/2;</span><br><span class="line">				//被碰撞圆的圆心 X 坐标</span><br><span class="line">				var staticRicY = static.offsetTop + static.offsetHeight/2;</span><br><span class="line">				// 被碰撞的圆的圆心 Y 坐标</span><br><span class="line"></span><br><span class="line">				var centerX = moveRicX - staticRicX;</span><br><span class="line">				var centerY = moveRicY -staticRicY;</span><br><span class="line">				var addRadial = moveRadial + staticRadial;</span><br><span class="line">				// 两圆相切的必要条件是圆心距小于它们的半径之和</span><br><span class="line">				if(centerX*centerX + centerY*centerY &lt;= addRadial*addRadial)&#123;</span><br><span class="line">					static.style.background = &quot;red&quot;;</span><br><span class="line">				&#125; else &#123;</span><br><span class="line">					static.style.background = &quot;green&quot;;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				move.style.left = event.clientX - relatiMouseX + &quot;px&quot;;</span><br><span class="line">				move.style.top = event.clientY - relatiMouseY + &quot;px&quot;;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		move.onmouseup = function ()&#123;</span><br><span class="line">			document.documentElement.onmousemove = null;</span><br><span class="line">		&#125;</span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="0x01-矩形碰撞检测"><a href="#0x01-矩形碰撞检测" class="headerlink" title="0x01 矩形碰撞检测"></a>0x01 矩形碰撞检测</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">for (var i = 0 ; i &lt; stop.length ; i++) &#123;</span><br><span class="line">	if (X+move.offsetWidth&gt;=stop[i].offsetLeft&amp;&amp;</span><br><span class="line">		X&lt;= stop[i].offsetLeft+stop[i].offsetWidth&amp;&amp;//处于被碰撞元素的 X 轴区域</span><br><span class="line">		Y+move.offsetHeight&gt;=stop[i].offsetTop&amp;&amp;</span><br><span class="line">		Y&lt;=stop[i].offsetTop+stop[i].offsetHeight//处于被碰撞元素的 Y 轴区域</span><br><span class="line">		) &#123;</span><br><span class="line">			stop[i].style.background = &quot;yellow&quot;</span><br><span class="line">			&#125;else&#123;</span><br><span class="line">			stop[i].style.background = &quot;green&quot;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/24/形状/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/24/形状/" itemprop="url">形状</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-24T00:00:00+08:00">
                2016-10-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-border-radius"><a href="#0x00-border-radius" class="headerlink" title="0x00 border-radius"></a>0x00 border-radius</h3><p><code>border-radius</code> 有一个鲜为人知的属性，它可以单独指定水平和垂直半径，只要用斜杠(/) 分隔这两个值即可。此外，它不仅可以接受数值单位，还可以接受百分比值。而这个百分比会基于元素的尺寸进行解析。</p>
<p>所以，要创建一个自适应的椭圆，只需将两个方向(水平和垂直)的半径都设置为 50%</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#box&#123;</span><br><span class="line">	width:400px;</span><br><span class="line">	height:200px;  								    border-radius: 50% / 50%;</span><br><span class="line">&#125;</span><br><span class="line">// or 进一步简化</span><br><span class="line">border-radius: 50%;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-21b56c4b582299bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="椭圆"></p>
<hr>
<h4 id="大值特性和等比例特性"><a href="#大值特性和等比例特性" class="headerlink" title="大值特性和等比例特性"></a>大值特性和等比例特性</h4><p>此外，<code>border-radius</code> 还有两个特性:<strong>大值特性</strong> 和<strong>等比例特性</strong></p>
<h5 id="大值特性"><a href="#大值特性" class="headerlink" title="大值特性"></a>大值特性</h5><p>也就是值很大的时候，只会使用能够渲染的圆角大小渲染。大值特性相对于元素自身的 width ,height而言。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#box &#123;</span><br><span class="line">width: 200px;</span><br><span class="line">height: 200px;</span><br><span class="line">background: deeppink;	</span><br><span class="line">border-radius: 50%;	</span><br><span class="line">/*border-radius:100%*/</span><br><span class="line">/*border-radius: 100px*/</span><br><span class="line">/*border-radius:200px;*/</span><br><span class="line">/*border-radius: 400px*/</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上，下面的渲染结果都是一样的，即最大渲染半径只能是 50%,100px;</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-b9fd9e4f143a868f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="border-radius的大值特性"></p>
<h5 id="等比例特性"><a href="#等比例特性" class="headerlink" title="等比例特性"></a>等比例特性</h5><p>等比例特性:水平半径和垂直半径的比例是恒定不变的。等比例特性相对设置的 <code>border-radius</code> 参数的比例而言的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#box &#123;</span><br><span class="line">width: 200px;</span><br><span class="line">height: 300px;</span><br><span class="line">background: deeppink;	</span><br><span class="line">border-radius: 300px 0 0 0/300px 0 0 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-001f1f424294e773.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="等比例特性"></p>
<p>元素占据宽度200像素，高度300像素。所以，根据<strong>大值特性</strong>，水平方向的300像素只能按照200像素半径渲染；再根据<strong>等比例特性</strong>，虽然垂直方向理论上的最大半径是300像素，但是受制于当初设定的300px<em>300px的1:1比例，垂直方向最终渲染的半径大小也是200像素。于是，我们最后得到的只是一个200像素</em>200像素的圆弧。</p>
<blockquote>
<p>最后值得注意的是，<code>border-radius</code> 属性中前面的方位关键字和后面的半径方位是不匹配.它们的关系是:<strong>border-垂直-水平-radius: 水平 垂直</strong></p>
</blockquote>
<p>OK,了解上面的东西以后我们可以开始使用 <code>border-radius</code> 来实现许多形状了，比如：</p>
<h5 id="半椭圆"><a href="#半椭圆" class="headerlink" title="半椭圆"></a>半椭圆</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#box &#123;</span><br><span class="line">	width: 200px;</span><br><span class="line">	height: 300px;</span><br><span class="line">	background: deeppink;	</span><br><span class="line">	border-radius: 50% / 100% 100% 0 0 ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-c1d3a8eb4419b943.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="半椭圆"></p>
<h5 id="四分之一椭圆"><a href="#四分之一椭圆" class="headerlink" title="四分之一椭圆"></a>四分之一椭圆</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#box &#123;</span><br><span class="line">	width: 200px;</span><br><span class="line">	height: 300px;</span><br><span class="line">	background: deeppink;	</span><br><span class="line">	border-radius: 100% 0 0 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-cd7ba157a9f67ba7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="四分之一椭圆"></p>
<hr>
<h3 id="0x01-平行四边形"><a href="#0x01-平行四边形" class="headerlink" title="0x01 平行四边形"></a>0x01 平行四边形</h3><p>我们很容易想到对矩形使用 <code>skew()</code> 变形属性来达到我们想要的效果，但是，这样势必导致其元素中的内容也会跟着被拉伸，于是，我们想到使用伪元素。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#box &#123;</span><br><span class="line">	width: 100px;</span><br><span class="line">	height: 40px;</span><br><span class="line">	margin: 100px auto;</span><br><span class="line">	margin-left:400px;			</span><br><span class="line">	text-align: center;</span><br><span class="line">	line-height: 40px;</span><br><span class="line">	/*其它文字，颜色，内边距等样式...*/				</span><br><span class="line">	position: relative;</span><br><span class="line">	/*设置宿主元素为相对定位*/</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#box:before &#123;</span><br><span class="line">	/*使用伪元素来生成一个矩形*/</span><br><span class="line">	content: &apos;&apos;;</span><br><span class="line">	position: absolute;</span><br><span class="line">	/*设置伪元素为绝对定位*/</span><br><span class="line">	left:0;</span><br><span class="line">	top:0;</span><br><span class="line">	right:0;</span><br><span class="line">	bottom: 0;</span><br><span class="line">	/*设置伪元素所有偏移量为0，使其自动继承宿主元素尺寸*/</span><br><span class="line">	z-index: -1;</span><br><span class="line">	/*将伪元素堆叠层次至于宿主元素之后*/</span><br><span class="line">	background: deeppink;	</span><br><span class="line">	transform:skewX(45deg);</span><br><span class="line">	/*使用skewX()变形*/</span><br><span class="line">	border:1px solid red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-02f7c073075f276b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="伪元素生成平行四边形"></p>
<p>这技巧的关键在于，利用伪元素及其定位属性产生了一个方块，然后对伪元素设置样式，并将其放置在宿主元素的下层。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/24/字体排版/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/24/字体排版/" itemprop="url">字体排版</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-24T00:00:00+08:00">
                2016-10-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x01-连字符断行"><a href="#0x01-连字符断行" class="headerlink" title="0x01 连字符断行"></a>0x01 连字符断行</h3><p>CSS3 添加了一新的属性,<code>hyphens</code>,它有三个值，<code>nome</code>,<code>normal</code>,<code>auto</code>。其作用是我们可以在任何时候手工插入软连字符，来实现断词折行的效果。只需要使用<code>hyphens:auto</code>就可以了。</p>
<hr>
<h3 id="0x02-插入换行"><a href="#0x02-插入换行" class="headerlink" title="0x02 插入换行"></a>0x02 插入换行</h3><p>下面将会使用自定义列表来做一个 Contact 模块。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">//HTML </span><br><span class="line">&lt;div id=&quot;contact&quot;&gt;</span><br><span class="line">	&lt;dl&gt;</span><br><span class="line">		&lt;dt&gt;Name:&lt;/dt&gt;</span><br><span class="line">		&lt;dd&gt;Jack&lt;/dd&gt;</span><br><span class="line"></span><br><span class="line">		&lt;dt&gt;Email:&lt;/dt&gt;</span><br><span class="line">		&lt;dd&gt;onejustone404@gmail.com&lt;/dd&gt;</span><br><span class="line">		&lt;dd&gt;0nejust0one@gmail.com&lt;/dd&gt;</span><br><span class="line"></span><br><span class="line">		&lt;dt&gt;Location:&lt;/dt&gt;</span><br><span class="line">		&lt;dd&gt;BeiJing&lt;/dd&gt;</span><br><span class="line">	&lt;/dl&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">// CSS</span><br><span class="line">dt,dd &#123;</span><br><span class="line">	display: inline;	</span><br><span class="line">	margin:0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dd &#123;</span><br><span class="line">	margin: 0;</span><br><span class="line">	font-weight: bold;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dd+dt::before &#123;</span><br><span class="line">	/*给每一个 dt 之前有 dd 的 dt 头部添加换行符*/</span><br><span class="line">	content: &apos;\A&apos;;</span><br><span class="line">	/* \A 相当于换行符*/</span><br><span class="line">	white-space:pre;</span><br><span class="line">	/*保留源代码中的空白符和换行符*/</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dd + dd:before &#123;</span><br><span class="line">	/*在每个前面有 dd 的 dd 的头部插入逗号*/</span><br><span class="line">	content: &apos;,&apos;;</span><br><span class="line">	margin-left: -0.25em;	</span><br><span class="line">        /*使用负 margin 去除多个连续的 dd 之间的空白符*/</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/20/JS事件(2)mousewheel和scrollTop/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/20/JS事件(2)mousewheel和scrollTop/" itemprop="url">JS事件(2)mousewheel和scrollTop</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-20T00:00:00+08:00">
                2016-10-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-浏览器的渲染兼容模式"><a href="#0x00-浏览器的渲染兼容模式" class="headerlink" title="0x00 浏览器的渲染兼容模式"></a>0x00 浏览器的渲染兼容模式</h3><p>全球的浏览器市场可谓三分天下，Chrome，FireFox，IE，而在各自的背后都追随着自己的若干小弟，它们各自都遵循这个共同渲染标准，同时也有用这属于自身的规范和特性。</p>
<p>我们可以通过<br><code>document.compatMode</code> 这个属性来检测浏览器的渲染模式，它 返回两个值，<code>BackCompat(混杂模式，怪异模式)</code> 和 <code>CSS1Compat(标准模式)</code>。</p>
<p>在<code>BackCompat</code> 模式下通过<code>document.body</code> 来获得页面的变化，而在<code>CSS1Compat</code>模式下<code>document.docuementElement</code>来获得页面变化。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">EventUtil.addHandler(window, &quot;scroll&quot;, function(event)&#123;</span><br><span class="line">	if(document.compatMode == &quot;CSS1Compat&quot;)&#123;</span><br><span class="line">		// 如果是在标准模式下,那么通过 &lt;html&gt; 元素来获得页面变化</span><br><span class="line">		console.log(document.documentElement.scrollTop);</span><br><span class="line">	&#125; else&#123;</span><br><span class="line">		// 如果是在混杂模式下，那么通过 &lt;body&gt; 元素来获得页面变化</span><br><span class="line">		console.log(document.body.scrollTop);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>比较有意思的是，如果我们想获得可视区域的高度，那么对于 FireFox，通过 <code>document.body.clientHeight</code> 和 <code>document.documentElement.clientHeight</code> 都是可行的，但是对于 Chrome 则只能通过 <code>document.documentElement.clientHeight</code> 才行得通。</p>
<hr>
<h3 id="0x01-Chrome-添加全局-mousewhell"><a href="#0x01-Chrome-添加全局-mousewhell" class="headerlink" title="0x01 Chrome 添加全局 mousewhell"></a>0x01 Chrome 添加全局 mousewhell</h3><p>方法一,通过给 <code>document.documentElement</code> 添加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">document.documentElement.onmousewheel = function(event)&#123;</span><br><span class="line">	event.preventDefault()</span><br><span class="line">	if(event.wheelDelta &lt;0)&#123;</span><br><span class="line">		document.body.scrollTop = 5400;</span><br><span class="line">		console.log(document.body,scrollTop);</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		document.body.scrollTop = -5400;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>方法二，通过给 <code>window</code> 添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">window.onmousewheel = function()&#123;</span><br><span class="line">	event.preventDefault()</span><br><span class="line">	if(event.wheelDelta &lt;0)&#123;</span><br><span class="line">		document.body.scrollTop = 5400;</span><br><span class="line">		console.log(document.body.scrollTop);</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		document.body.scrollTop = -5400;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="0x03-兼容FireFox和Chrome的-mousewheelScrollTop"><a href="#0x03-兼容FireFox和Chrome的-mousewheelScrollTop" class="headerlink" title="0x03 兼容FireFox和Chrome的 mousewheelScrollTop"></a>0x03 兼容FireFox和Chrome的 mousewheelScrollTop</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">var EventUtil = &#123;</span><br><span class="line">		addHandler: function(element,type,handler)&#123;</span><br><span class="line">                        if(element.addEventListener)&#123;</span><br><span class="line">				element.addEventListener(type, handler);</span><br><span class="line">			&#125; else if (element.attachEvent)&#123;</span><br><span class="line">				element.attachEvent(type, handler);</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				element[&quot;on&quot; + type] = handler;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		getEvent: function(event)&#123;</span><br><span class="line">			return event ? event : window.event;</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		getTarget: function(event)&#123;</span><br><span class="line">			return event.target || event.srcElement;</span><br><span class="line">		&#125;,</span><br><span class="line">		preventDefault: function(event)&#123;</span><br><span class="line">			if(event.preventDefault)&#123;</span><br><span class="line">				event.preventDefault();</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				event.returnValue = false;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		removeHandler: function()&#123;</span><br><span class="line">			if (element.removeElementListener)&#123;</span><br><span class="line">				element.removeElementListener(type,handler);</span><br><span class="line">			&#125; else if (element.detachEvent)&#123;</span><br><span class="line">				element.detachEvent;</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				element[&quot;on&quot; + type] = null;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		stopPropagation: function()&#123;</span><br><span class="line">			if(event.stopPropagation)&#123;</span><br><span class="line">				event.stopPropagation();</span><br><span class="line">			&#125; else&#123;</span><br><span class="line">				event.cancelBubble = true;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		getWheelDelta:function(event)&#123;</span><br><span class="line">			if(event.wheelDelta)&#123;</span><br><span class="line">            	return event.wheelDelta;</span><br><span class="line">        	&#125; else &#123;</span><br><span class="line">            	return -event.detail*40;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">	function mousewheelScrollTop (event)&#123;</span><br><span class="line">		var event = EventUtil.getEvent(event)</span><br><span class="line">		EventUtil.preventDefault(event);</span><br><span class="line">		var wheelDelta = EventUtil.getWheelDelta(event);</span><br><span class="line">		console.log(wheelDelta);</span><br><span class="line">		if(wheelDelta&lt;0)&#123;</span><br><span class="line"></span><br><span class="line">			if(document.compatMode==&quot;CSS1Compat&quot;)&#123;</span><br><span class="line">			// FireFox</span><br><span class="line">				document.documentElement.scrollTop = 5000;</span><br><span class="line">			&#125;else&#123;</span><br><span class="line">			// Chrome</span><br><span class="line">				document.body.scrollTop = 5000;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			if(document.compatMode==&quot;CSS1Compat&quot;)&#123;</span><br><span class="line">				document.documentElement.scrollTop = -5000;</span><br><span class="line">			&#125;else&#123;</span><br><span class="line">				document.body.scrollTop = -5000;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	EventUtil.addHandler(window,&quot;DOMMouseScroll&quot;,mousewheelScrollTop);</span><br><span class="line">	EventUtil.addHandler(window,&quot;mousewheel&quot;,mousewheelScrollTop);</span><br></pre></td></tr></table></figure>
<h2 id="scrollTop-注意事项"><a href="#scrollTop-注意事项" class="headerlink" title="scrollTop 注意事项"></a>scrollTop 注意事项</h2><p>当页面有DTD文档说明时:使用document.body.scrollTop的值总是0.此时需要使用document.documentElement.scrollTop.</p>
<p>页面具有 DTD（或者说指定了 DOCTYPE）时，使用 document.documentElement。<br>页面不具有 DTD（或者说没有指定了 DOCTYPE）时，使用 document.body。<br>在 IE 和 Firefox 中均是如此。<br>为了兼容，可以使用如下代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> scrollTop = <span class="built_in">window</span>.pageYOffset</span><br><span class="line">|| <span class="built_in">document</span>.documentElement.scrollTop</span><br><span class="line">|| <span class="built_in">document</span>.body.scrollTop</span><br><span class="line">|| <span class="number">0</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/20/JS事件(1)事件初见/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/20/JS事件(1)事件初见/" itemprop="url">JS事件(1)事件初见</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-20T00:00:00+08:00">
                2016-10-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x01-事件处理程序"><a href="#0x01-事件处理程序" class="headerlink" title="0x01 事件处理程序"></a>0x01 事件处理程序</h3><p>事件是用户或者浏览器自身执行的某种动作。而响应某个事件的函数叫做<strong>事件处理程序</strong>。</p>
<hr>
<h4 id="DOM0-级事件处理程序"><a href="#DOM0-级事件处理程序" class="headerlink" title="DOM0 级事件处理程序"></a>DOM0 级事件处理程序</h4><blockquote>
<p>在所有浏览器中，对于 DOM0 级事件，事件处理程序都只会也只能在事件冒泡阶段被处理。</p>
</blockquote>
<p>DOM0 级事件处理是将一个函数赋值给一个事件处理程序属性来实现的。</p>
<p>每个元素(包括 window 和 document)都有自己的事件处理程序属性，这些属性通常小写，例如 onclick。</p>
<p>事件处理程序的名字以 <code>on</code> 开头。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var btn = document.getElementById(&quot;myBtn&quot;);</span><br><span class="line">btn.onclick = function()&#123;</span><br><span class="line">    alert(this.id)// &quot;myBtn&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>使用 DOM0 级方法指定的事件处理程序被认为是元素的方法。因此，这时的事件处理程序是在元素的作用域中运行。程序中的 <code>this</code> 指代的是当前元素。</p>
<p>DOM0 级对每个事件只支持一个事件处理程序。</p>
<hr>
<h4 id="DOM2-级事件处理程序"><a href="#DOM2-级事件处理程序" class="headerlink" title="DOM2 级事件处理程序"></a>DOM2 级事件处理程序</h4><p>DOM2 级中的两个方法: <code>addEventListener()</code> <strong>添加事件处理程序</strong> 和 <code>removeEventListener()</code> <strong>移除事件处理程序</strong>。</p>
<p>它们接收三个相同的参数:事件名，事件处理函数，一个布尔值。如果布尔值为 true，表示在捕获阶段调用事件处理程序，false 表示在冒泡阶段调用事件处理程序。所有浏览器默认都为 falase.</p>
<p>使用 DOM2 级事件处理程序的好处是可以添加多个事件处理程序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">		var btn = document.querySelector(&quot;#myBtn&quot;);</span><br><span class="line">		btn.addEventListener(&quot;click&quot;,function()&#123;</span><br><span class="line">			alert(this.id);</span><br><span class="line">		&#125;,false);</span><br><span class="line"></span><br><span class="line">		btn.addEventListener(&quot;click&quot;,function()&#123;</span><br><span class="line">			alert(&quot;word!&quot;);</span><br><span class="line">		&#125;,false);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>btn 中的两个事件处理程序会按照添加它们的顺序先后执行，首先弹出 ID，然后显示 word.</p>
<p>使用 addEventListener( 添加的事件只能使用 removeEventListener() 来移除，并且与 addEventListener() 传入的参数相同，这个意味着无法移除使用 addEventListener() 添加的匿名函数。</p>
<hr>
<h4 id="IE-事件处理程序"><a href="#IE-事件处理程序" class="headerlink" title="IE 事件处理程序"></a>IE 事件处理程序</h4><p>IE 中使用 <strong>attachEvent()</strong> 和 <strong>detachEvent()</strong> 来操作事件。两个方法接收两个相同的参数:事件处理程序名称与事件处理程序。因为 IE 只支持冒泡(IE8以下,所以没有第三个参数)</p>
<blockquote>
<p>实际上，attachEvent 主要是为了兼容 IE8以下。从 IE9 开始，可以使用标准的 addEventLister 来使用 DOM2 级事件了。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vat btn = document.querySelector(&quot;#myBtn&quot;);</span><br><span class="line">btn.attachEvent(&quot;onclick&quot;,function()&#123;</span><br><span class="line">    alert(this === window); //true</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>attachEvent() 与 DOM0 级方法的区别在于事件处理程序的作用域。DOM0 级中，事件处理程序会在所属元素的作用域内运行。而使用 attachEvent() 方法，事件处理程序会在全局作用域中运行，因此 this 等于 window。</p>
<p>同样，attachEvent() 也可为同一元素添加不同事件，但是不同于 DOM0 级方法，IE 中的这些事件是以相反的顺序被触发的。</p>
<p>detachEvent() 方法同样不能移除匿名函数。</p>
<p>attachEvent() 方法添加的事件只会在冒泡阶段被处理。</p>
<hr>
<h4 id="夸浏览器的事件处理程序"><a href="#夸浏览器的事件处理程序" class="headerlink" title="夸浏览器的事件处理程序"></a>夸浏览器的事件处理程序</h4><p>考虑到不同浏览器之间操作事件处理程序的差异，我们可以使用专门的库或者编写自己的兼容程序来处理不同的浏览器中的情况。</p>
<p>我们将创建一个 <strong>EventUtil 对象</strong>，并为其添加<strong>addHandler()</strong> 方法和 <strong>removeHandler()</strong> 方法。它的作用是视情况分别使用 DOM0 级方法，DOM2 级方法或 IE 方法来添加事件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">var EventUtil = &#123;</span><br><span class="line">			addHandler:function (element, type, handler)&#123;</span><br><span class="line">				if (element.addEventListener)&#123;</span><br><span class="line">// 所有现代浏览器都可以使用的方法，IE9，firefox，chrome</span><br><span class="line">					element.addEventListener(type, handler, false);</span><br><span class="line">				&#125; else if(element.attachEvent)&#123;</span><br><span class="line">				// 主要是为了兼容 IE8，IE8 是最后一个使用专用事件系统的主流浏览器。	element.attachEvent(&quot;on&quot;+type,handler)</span><br><span class="line"></span><br><span class="line">				&#125;else&#123;</span><br><span class="line">					element[&quot;on&quot; + type] = handler;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line"></span><br><span class="line">			removeHandler:function (element,type,handler)&#123;</span><br><span class="line">				if (element.removeEventListener)&#123;</span><br><span class="line">					element.removeEventListener(type, handler,false)</span><br><span class="line">			        &#125; else if (element.detachEvent)&#123;</span><br><span class="line">					element.detachEvent(type, handler)</span><br><span class="line">				&#125; else &#123;</span><br><span class="line">					element[&quot;on&quot; + type] = null;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>以上的两个方法首先会检测传入的元是否存在 DOM2 级方法，若存在就使用它。如果存在的是 IE 中的方法，则采取第二种方案。为了在 IE8 级更早的版本中运行，我们为事件类型添加了 <strong>on</strong> 前缀。</p>
<p>显然，我们没有考虑到所有的问题，比如在 IE 中的作用域问题，不过使用它们添加和删除事件处理程序还是足够了。</p>
<hr>
<h3 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h3><p>触发 DOM 上的事件时，会产生一个事件对象 <strong>event</strong>,它包含着所有与事件有关的信息。比如导致事件的元素，事件的类型以及与其它特定事件相关的信息。</p>
<h5 id="DOM-的事件对象"><a href="#DOM-的事件对象" class="headerlink" title="DOM 的事件对象"></a>DOM 的事件对象</h5><p>兼容 DOM 的浏览器会将一个 event 对象传入到事件处理程序中，而无论指定事件处理程序时使用的什么方法(DOM0 级或 DOM2 级),都会传入 event 对象。</p>
<p>event 对象包含与创建它的特定事件有关的属性和方法。触发的事件类型不一样，可用的属性和方法也不一样。DOM 中所有事件都具有以下成员:</p>
<table>
<thead>
<tr>
<th style="text-align:right">属性/方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">bubbles</td>
<td style="text-align:center">布尔</td>
<td style="text-align:left">表明事件是否冒泡</td>
</tr>
<tr>
<td style="text-align:right">cancelable</td>
<td style="text-align:center">布尔</td>
<td style="text-align:left">表明是否可以取消事件的默认行为</td>
<td></td>
</tr>
<tr>
<td style="text-align:right">preventDefault</td>
<td style="text-align:center">函数</td>
<td style="text-align:left">取消事件的默认行为(cancelable 为则可以使用该方法)</td>
<td></td>
</tr>
<tr>
<td style="text-align:right">stopPropagation</td>
<td style="text-align:center">函数</td>
<td style="text-align:left">取消事件的进一步捕获或冒泡(bubbles为true则可以使用该方法)</td>
<td></td>
</tr>
<tr>
<td style="text-align:right">target</td>
<td style="text-align:center">元素</td>
<td style="text-align:left">事件的目标</td>
<td></td>
</tr>
<tr>
<td style="text-align:right">type</td>
<td style="text-align:center">字符串</td>
<td style="text-align:left">被触发的事件的类型</td>
</tr>
</tbody>
</table>
<p>在需要通过一个函数处理多个事件时，可以使用 type 属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var btn = document.querySelector(&quot;#myBtn&quot;);</span><br><span class="line">var handler = function (event) &#123;</span><br><span class="line">	// body...</span><br><span class="line">	switch(event.type)&#123;</span><br><span class="line">		case &quot;click&quot;:</span><br><span class="line">			alert(&quot;Clicked&quot;);</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		case &quot;mouseover&quot;:</span><br><span class="line">			event.target.style.backgroundColor = &quot;red&quot;;</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		case &quot;mouseout&quot;:</span><br><span class="line">			event.target.style.backgroundColor = &quot;green&quot;;</span><br><span class="line">			break;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">btn.onclick = handler;</span><br><span class="line">btn.onmouseover = handler;</span><br><span class="line">btn.onmouseout = handler;</span><br></pre></td></tr></table></figure>
<p>此外，我们可以使用 preventDefault() 方法来阻止特定事件的默认行为。</p>
<p>最后，还可以使用 stopPropagation() 方法来立即停止事件在 DOM 层次中的传播，即取消进一步事件的捕获或冒泡。</p>
<hr>
<h4 id="IE-中的事件对象"><a href="#IE-中的事件对象" class="headerlink" title="IE  中的事件对象"></a>IE  中的事件对象</h4><p>不同于 DOM 中的 event 对象，要访问 IE 中的 event 对象，取决于事件处理程序的方法。在 IE 中使用 DOM0 级方法添加事件时， event 对象将会作为 window 对象的一个属性存在。若是使用 attachEvent() 方法添加事件，便会有一个 event 对象作为参数被传入事件处理程序函数中。如果是通过 HMTL 特性指定事件处理程序，那么还可以通过一个 event 的变量来访问 event 对象。</p>
<p>当然, IE 中的 event 也包含与创建它的事件相关的属性和方法，并且与 DOM 中的属性与方法类型。</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性/方法</th>
<th style="text-align:center">类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">cancelBubble</td>
<td style="text-align:center">布尔</td>
<td>默认值为 false ，但将其设置为 true 便可取消事件冒泡(等价于 stopPropagation())</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">returnValue</td>
<td style="text-align:center">布尔</td>
<td>默认为 true，将其设置为 false</td>
<td>可取消事件默认行为(等价于preventDefault())</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">srcElement</td>
<td style="text-align:center">元素</td>
<td>事件的目标(等价于 target 属性)</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">type</td>
<td style="text-align:center">字符串</td>
<td>事件类型</td>
<td></td>
</tr>
</tbody>
</table>
<hr>
<h4 id="夸浏览器的事件对象"><a href="#夸浏览器的事件对象" class="headerlink" title="夸浏览器的事件对象"></a>夸浏览器的事件对象</h4><p>显然，DOM 标准和 IE 中的 event 对象不同，但是基于它们之间的相似性，我们依旧可以写出夸浏览器的方案。因为 IE 中event 对象的全部信息和方法 DOM 对象中都有，只不过实现方式不一样。</p>
<p>我们通过对 EventUtil 对象的增强来到达不同浏览器之间的兼容性问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">var EventUtil = &#123;</span><br><span class="line">		addHandler: function(element,type,handler)&#123;</span><br><span class="line">                        if(element.addEventListener)&#123;</span><br><span class="line">				element.addEventListener(type, handler);</span><br><span class="line">			&#125; else if (element.attachEvent)&#123;</span><br><span class="line">				element.attachEvent(type, handler);</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				element[&quot;on&quot; + type] = handler;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		getEvent: function(event)&#123;</span><br><span class="line">			return event ? event : window.event;</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		getTarget: function(event)&#123;</span><br><span class="line">			return event.target || event.srcElement;</span><br><span class="line">		&#125;,</span><br><span class="line">		preventDefault: function(event)&#123;</span><br><span class="line">			if(event.preventDefault)&#123;</span><br><span class="line">				event.preventDefault();</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				event.returnValue = false;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		removeHandler: function()&#123;</span><br><span class="line">			if (element.removeElementListener)&#123;</span><br><span class="line">				element.removeElementListener(type,handler);</span><br><span class="line">			&#125; else if (element.detachEvent)&#123;</span><br><span class="line">				element.detachEvent;</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				element[&quot;on&quot; + type] = null;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		stopPropagation: function()&#123;</span><br><span class="line">			if(event.stopPropagation)&#123;</span><br><span class="line">				event.stopPropagation()；</span><br><span class="line">			&#125; else&#123;</span><br><span class="line">				event.cancelBubble = true;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="0x01-事件类型"><a href="#0x01-事件类型" class="headerlink" title="0x01 事件类型"></a>0x01 事件类型</h3><p>DOM3 级规定了以下几个事件: UI 事件，焦点事件，鼠标事件，滑轮事件，文本事件，键盘事件，合成事件(当 Input Method Editor 输入字符时触发)，变动事件(DOM 底层结构发生变化时触发)</p>
<p>包括 IE9 在内的所有主流浏览器都支持 DOM2 事件和 DOM3 级事件。</p>
<hr>
<h4 id="UI-事件"><a href="#UI-事件" class="headerlink" title="UI 事件"></a>UI 事件</h4><h5 id="load"><a href="#load" class="headerlink" title="load"></a>load</h5><p>在页面加载完成以后(所有图像，JavaScript文件，CSS文件等等)便会触发 window 上的 <code>onload 事件</code>。</p>
<p>显示是 load 事件的使用场景。</p>
<p>在 <code>docuement</code> 上定义 load 事件:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventUtil.addHaneler(document, &apos;load&apos;, callback)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>DOM2 级规范规定，应该在 document 而非 window 上触发 load 事件，使用 window 仅仅是为了向后兼容。<br>图片预加载:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">EventUtil.addHandler(window, &apos;load&apos;,function()&#123;</span><br><span class="line">// 确保页面加载完成，否则</span><br><span class="line">操作 document.body 会报错</span><br><span class="line">	var image = document.createElement(&apos;img&apos;);</span><br><span class="line">	EventUtil.addHandler(image, &apos;load&apos;, function(event)&#123;</span><br><span class="line">		event = EventUtil.getEvent(event);		</span><br><span class="line">	&#125;)</span><br><span class="line">	document.body.appendChild(image);</span><br><span class="line">	image.src = &quot;simle.gif&quot;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>动态加载 JavaScript:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">EventUtil.addHandler(document,&apos;load&apos;, function()&#123;</span><br><span class="line">var script = document.createElement(&apos;script&apos;)</span><br><span class="line">	EventUtil.addHandler(script, &apos;load&apos;, function()&#123;</span><br><span class="line">	console.log(&apos;yes,JavaScript&apos;)</span><br><span class="line">	&#125;)</span><br><span class="line">	script.src = &apos;example.js&apos;</span><br><span class="line">	document.body.appendChild(script)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>
<p>不同于图片加载，只有在设置了 <script> 元素的 src 属性并将其添加到文档后，才会开始下载。</p>
<h5 id="unload"><a href="#unload" class="headerlink" title="unload"></a>unload</h5><p>从一个页面切换到另一页面时便会触发 unload 事件。利用这个事件最多的情况是清除引用，以次避免内存泄漏。</p>
<blockquote>
<p>根据 DOM2 级事件，应该在 body 上触发 unload 事件，而不是 window 上，同样使用 window 只是为了兼容</p>
</blockquote>
<h4 id="resize"><a href="#resize" class="headerlink" title="resize"></a>resize</h4><p>该事件在 window 上被触发.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventUtil.addHandler(window,&apos;resize&apos;,callback);</span><br></pre></td></tr></table></figure>
<h5 id="scroll"><a href="#scroll" class="headerlink" title="scroll"></a>scroll</h5><p>scroll 事件是在 window 对象上发生的，但是其实际表示的是页面中相应元素的变化。<br>混杂模式下通过 <code>body</code> 元素的 scrollLeft 和scrollTop 来监控；标准模式下，通过 <html> 元素跟踪页面变化。这里是个大坑。</p>
<hr>
<h4 id="焦点事件"><a href="#焦点事件" class="headerlink" title="焦点事件"></a>焦点事件</h4><p>焦点是事件会在页面失去焦点或得到焦点时触发。这类事件最主要的两个方法是 <code>focus</code> 和 <code>blur</code>。</p>
<hr>
<h4 id="鼠标事件"><a href="#鼠标事件" class="headerlink" title="鼠标事件"></a>鼠标事件</h4><p>DOM3 级中定义了 9 个鼠标事件：</p>
<ul>
<li>click：单击主鼠标按钮时触发</li>
<li>dblclick:双击主鼠标按钮时触犯</li>
<li>mousedown:按下任意鼠标按钮时触发</li>
<li>mouseup: 释放鼠标按钮时触发</li>
<li>mouseout: 鼠标划出时触发</li>
<li>mouseover: 鼠标滑过时触发</li>
<li>mousewheel: 鼠标滚轮事件</li>
<li>mouseenter: 仅IE9 ,FireFox9,, Opera支持</li>
<li>mouseleave: 仅IE9 ,FireFox9,, Opera支持</li>
</ul>
<h5 id="客户区的位置"><a href="#客户区的位置" class="headerlink" title="客户区的位置"></a>客户区的位置</h5><p>鼠标的位置信息保存在事件对象的 <code>clientX</code>  和 <code>clientY</code> 属性中。它们的值表示在事件发生时，鼠标指针在可视区域中的水平和垂直位置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var section = document.querySelector(&quot;section&quot;);</span><br><span class="line">EventUtil.addHandler(section, &quot;click&quot;,function()&#123;</span><br><span class="line">	event = EventUtil.getEvent(event);</span><br><span class="line">	console.log(event.clientX + &quot;,&quot; + event.clientY);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="页面坐标位置"><a href="#页面坐标位置" class="headerlink" title="页面坐标位置"></a>页面坐标位置</h5><p>我们可以通过 <code>pageX</code> 和 <code>pageY</code> 属性获得鼠标在页面中的位置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var section = document.querySelector(&quot;section&quot;);</span><br><span class="line">EventUtil.addHandler(section, &quot;click&quot;,function()&#123;</span><br><span class="line">	event = EventUtil.getEvent(event);</span><br><span class="line">	console.log(event.pageX + &quot;,&quot; + event.pageY);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>IE8 及其更早版本并不支持事件对象上的页面坐标。但是我们可以通过客户区坐标及其滚动坐标计算出来页面坐标。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var pageX = event.pageX,</span><br><span class="line">    pageY = event.pageY;</span><br><span class="line">if(pageX == undefined) &#123; pageX = event.clientX + (document.body.scrolltop || document.documentElement.scrollTop); &#125;</span><br><span class="line"></span><br><span class="line">if(pageY == undefined) &#123; pageY = event.clientY + (document.body.scrollLeft || document.documentElement.scrollLeft);&#125;</span><br></pre></td></tr></table></figure>
<h5 id="屏幕坐标位置"><a href="#屏幕坐标位置" class="headerlink" title="屏幕坐标位置"></a>屏幕坐标位置</h5><p>顾名思义，就是当事件发生时，鼠标相对于整个电脑屏幕的位置。我们可以通过 <code>screenX</code>  和 <code>screenY</code>  来获得它们的值。</p>
<h5 id="onclick-鼠标点击事件"><a href="#onclick-鼠标点击事件" class="headerlink" title="onclick 鼠标点击事件"></a>onclick 鼠标点击事件</h5><h6 id="点击按钮选中-checkbox-checked属性值"><a href="#点击按钮选中-checkbox-checked属性值" class="headerlink" title="点击按钮选中 checkbox checked属性值"></a>点击按钮选中 checkbox checked属性值</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">	&lt;button id = &quot;selectAll&quot;&gt;Select All&lt;/button&gt;</span><br><span class="line">	&lt;button id = &quot;cancelAll&quot;&gt;Cancel&lt;/button&gt;</span><br><span class="line">	&lt;ul&gt;</span><br><span class="line">		&lt;li&gt;&lt;input type=&quot;checkbox&quot; name = &quot;checkInput&quot;&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li&gt;&lt;input type=&quot;checkbox&quot; name = &quot;checkInput&quot;&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li&gt;&lt;input type=&quot;checkbox&quot; name = &quot;checkInput&quot;&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li&gt;&lt;input type=&quot;checkbox&quot; name = &quot;checkInput&quot;&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li&gt;&lt;input type=&quot;checkbox&quot; name = &quot;checkInput&quot;&gt;&lt;/li&gt;</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">	var btnSelectAll = document.getElementById(&quot;selectAll&quot;);</span><br><span class="line">	var btnCancelAll = document.getElementById(&quot;cancelAll&quot;);</span><br><span class="line">	var checkArray = document.getElementsByName(&quot;checkInput&quot;);</span><br><span class="line"></span><br><span class="line">	btnSelectAll.onclick = function ()&#123;</span><br><span class="line">		for(var i = 0; i &lt; checkArray.length; i++)&#123;</span><br><span class="line">			checkArray[i].checked = true;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	btnCancelAll.onclick = function ()&#123;</span><br><span class="line">		for(var i = 0; i &lt; checkArray.length; i++)&#123;</span><br><span class="line">			checkArray[i].checked = false;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="鼠标滑轮事件"><a href="#鼠标滑轮事件" class="headerlink" title="鼠标滑轮事件"></a>鼠标滑轮事件</h4><p>任何元素都可以触发 mousewheel 事件，只需将其指定给页面中的元素或者 document 对象，即可处理鼠标滚轮的交互操作。</p>
<p>与 <code>mousewheel</code> 事件对应的 <code>evet</code> 对象除了包含鼠标事件的所有标准信息外，还包含一个特殊的 <code>wheelDelta</code> 属性。当鼠标滚轮向前滑动时，wheelDelta 是120的倍数；当滚轮向后滑动时，wheelDelta 是 -120 的倍数。</p>
<p>而 FireFox 支持的是一个 <code>DOMMouseScroll</code> 的类似事件，而有关鼠标滚轮有关的信息则保存在 <code>detail</code> 属性中，当向前滑动鼠标滚轮时，该属性的值是 -3 的倍数，当向后滑动鼠标滚轮时，该属性值是 3 的倍数。</p>
<p>此外，Oprea 9.5 之前的版本中， wheelDelta 值的正负号是相反的。</p>
<h5 id="取得鼠标滑轮增量-delta-兼容方法"><a href="#取得鼠标滑轮增量-delta-兼容方法" class="headerlink" title="取得鼠标滑轮增量(delta)兼容方法"></a>取得鼠标滑轮增量(delta)兼容方法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var EventUtil = &#123;</span><br><span class="line">    getWheelDelta:function()&#123;</span><br><span class="line">        if(event.wheelDelta)&#123;</span><br><span class="line">            return (client.engine.opera &amp;&amp; client.engine.opera &lt; 9.5 ? -event.wheelDelta : event.wheelDelta);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return -event.detail*40;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>如此，便可以将相同的事件处理程序指定给 <code>mousewheel</code> 和 <code>DOMMouseScroll</code> 事件了。</p>
<hr>
<h4 id="键盘与文本事件"><a href="#键盘与文本事件" class="headerlink" title="键盘与文本事件"></a>键盘与文本事件</h4><ul>
<li>keydown: 按下键盘上的<strong>任意键</strong>时触发</li>
<li>keypress: 按下<strong>字符键</strong>时触发</li>
<li>keyup: 释放键盘上的键时触发</li>
<li>textInput: (DOM3 级事件)在文本插入文本框之前会触发 textInput 事件。</li>
</ul>
<p>此外，另一个 <code>textInput</code>事件是对 <code>keypress</code> 事件的补充，旨在将文本显示给用户之前更容易拦截文本。其主要考虑的是字符，因此因此它的 event 对象中还包含一个 data 属性，该属性的值就是用户输入的值。</p>
<h6 id="键码"><a href="#键码" class="headerlink" title="键码"></a>键码</h6><p>当发生 <code>keydown</code> 和 <code>keyup</code> 事件时，<code>event</code> 对象的 <code>keyCode</code> 属性会包含一个代码，与键盘上的一个特定的键对应。</p>
<p>DOM 和 IE 中的 event 对象都支持 keyCode 属性。</p>
<h6 id="字符码"><a href="#字符码" class="headerlink" title="字符码"></a>字符码</h6><p>当触发  <code>keypress</code> 事件时，绝大部分的浏览的 <code>event</code> 对象都会将该键对应的 ASCII 码保存在 <code>charCode</code> 属性中，而此时的 keyCode 属性的值可能为0或等于所按键的键码。</p>
<p>IE8 及之前版本和 Opera 则是在 keyCode 中保存字符的 ASCII 码。</p>
<blockquote>
<p>在所有浏览器中按下能够插入和删除字符的键都会触发 keypress 事件。</p>
</blockquote>
<h6 id="以跨浏览器的方法取得字符编码"><a href="#以跨浏览器的方法取得字符编码" class="headerlink" title="以跨浏览器的方法取得字符编码"></a>以跨浏览器的方法取得字符编码</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var EventUtil = &#123;</span><br><span class="line">    getCharCode: function () &#123;</span><br><span class="line">        if (typeof event.charCode == &quot;number&quot;)&#123;</span><br><span class="line">            return event.charCode;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return event.keyCode;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="文本框事件"><a href="#文本框事件" class="headerlink" title="文本框事件"></a>文本框事件</h5><p>input<br>change<br>focus<br>blur</p>
<hr>
<h4 id="HTML5-事件"><a href="#HTML5-事件" class="headerlink" title="HTML5 事件"></a>HTML5 事件</h4><h5 id="contextmeun-事件"><a href="#contextmeun-事件" class="headerlink" title="contextmeun 事件"></a>contextmeun 事件</h5><p>通过单击鼠标右键，便可以调出上下文菜单。 <code>contextmenu</code> 事件是冒泡的，所以可以为 document 指定一个事件处理程序，以处理页面总的所有类似事件。</p>
<hr>
<h3 id="0x02-内存和性能"><a href="#0x02-内存和性能" class="headerlink" title="0x02 内存和性能"></a>0x02 内存和性能</h3><hr>
<h4 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h4><p><strong>事件委托</strong> 利用了事件冒泡，只指定一个事件处理程序就可以管理某一类型的事件。它的主要作用便解决”事件处理程序过多”的问题。</p>
<p>使用事件委托，只需在 DOM 树中尽量最高的层次上添加一个事件处理程序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul id=&quot;myLinks&quot;&gt;</span><br><span class="line">	&lt;li id=&quot;doSomething&quot;&gt;Do something&lt;/li&gt;</span><br><span class="line">	&lt;li id=&quot;goSomewhere&quot;&gt;Go somewhere&lt;/li&gt;</span><br><span class="line">	&lt;li id=&quot;sayHi&quot;&gt;Say Hi&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">EventUtil.addHandler(myLinks,&quot;click&quot;,function(event)&#123;</span><br><span class="line">	var event = EventUtil.getEvent(event);</span><br><span class="line">	var target = EventUtil.getTarget(event);</span><br><span class="line">	switch(target.id)&#123;</span><br><span class="line"></span><br><span class="line">		case &quot;doSomething&quot;:</span><br><span class="line">			console.log(target.id);</span><br><span class="line">			document.title = &quot;I changed the document&apos;s title&quot;;</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		case &quot;goSomewhere&quot;:</span><br><span class="line">			console.log(target.id);</span><br><span class="line">			location.href = &quot;http://www.baidu.com&quot;;</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		case &quot;sayHi&quot;:</span><br><span class="line">			alert(&quot;Say Hi&quot;);</span><br><span class="line">			break;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</script></p>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/20/瀑布流/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/20/瀑布流/" itemprop="url">瀑布流</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-20T00:00:00+08:00">
                2016-10-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-瀑布流"><a href="#0x00-瀑布流" class="headerlink" title="0x00 瀑布流"></a>0x00 瀑布流</h3><p>HTML 代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">	&lt;title&gt;瀑布流&lt;/title&gt;</span><br><span class="line">	&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;pubuliu.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;id id=&quot;weaper&quot;&gt;</span><br><span class="line">		&lt;ul class=&quot;container&quot;&gt;&lt;li class=&quot;itemBox&quot;&gt;&lt;/li&gt;&lt;/ul&gt;		</span><br><span class="line">		&lt;ul class=&quot;container&quot;&gt;&lt;/ul&gt;</span><br><span class="line">		&lt;ul class=&quot;container&quot;&gt;&lt;/ul&gt;</span><br><span class="line">		&lt;ul class=&quot;container&quot;&gt;&lt;/ul&gt;</span><br><span class="line">	&lt;/id&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;pubuliu.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>CSS  代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">*&#123;</span><br><span class="line">	margin: 0;</span><br><span class="line">	padding: 0;</span><br><span class="line">	list-style:none;</span><br><span class="line">	box-sizing: border-box;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">body&#123;</span><br><span class="line">	background: red;</span><br><span class="line">	max-width: 1200px;</span><br><span class="line">	overflow-y: scroll;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.container &#123;</span><br><span class="line">	float: left;</span><br><span class="line">	width: 22%;</span><br><span class="line">	padding: 10px;</span><br><span class="line">	border: 1px solid green;</span><br><span class="line">	margin: 1%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.itemBox &#123;</span><br><span class="line">	width: 100%;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.itemBox img &#123;</span><br><span class="line">	width: 100%;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>JS 代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">var container = document.querySelectorAll(&quot;.container&quot;);</span><br><span class="line">console.log(container)</span><br><span class="line">var imageCount = [1];</span><br><span class="line"></span><br><span class="line">var EventUntil = &#123;</span><br><span class="line">	addHandler: function(element,type,handler)&#123;</span><br><span class="line">		if(element.addEventListener)&#123;</span><br><span class="line">			element.addEventListener(type, handler);</span><br><span class="line">		&#125; else if (element.attachEvent)&#123;</span><br><span class="line">			element.attachEvent(type, handler);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			element[&quot;on&quot; + type] = handler;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	getEvent: function(event)&#123;</span><br><span class="line">		return event ? event : window.event;</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	getTarget: function(event)&#123;</span><br><span class="line">		return event.target || event.srcElement;</span><br><span class="line">	&#125;,</span><br><span class="line">	preventDefault: function(event)&#123;</span><br><span class="line">		if(event.preventDefault)&#123;</span><br><span class="line">			event.preventDefault();</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			event.returnValue = false;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	removeHandler: function()&#123;</span><br><span class="line">		if (element.removeElementListener)&#123;</span><br><span class="line">			element.removeElementListener(type,handler);</span><br><span class="line">		&#125; else if (element.detachEvent)&#123;</span><br><span class="line">			element.detachEvent;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			element[&quot;on&quot; + type] = null;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	stopPropagation: function()&#123;</span><br><span class="line">		if(event.stopPropagation)&#123;</span><br><span class="line">			event.stopPropagation();</span><br><span class="line">		&#125; else&#123;</span><br><span class="line">			event.cancelBubble = true;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">	getWheelDelta:function(event)&#123;</span><br><span class="line">		if(event.wheelDelta)&#123;</span><br><span class="line">			return event.wheelDelta;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			return -event.detail*40;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">function createLi ()&#123;</span><br><span class="line"></span><br><span class="line">	if(imageCount.length &lt;= 75)&#123;</span><br><span class="line">		var newImage = new Image();</span><br><span class="line">		newImage.src = &quot;rendering/&quot;+imageCount.length + &quot;-&quot; + &quot;.jpg&quot;;</span><br><span class="line">		newImage.onload = function ()&#123;</span><br><span class="line">			var ulHeight = []</span><br><span class="line"></span><br><span class="line">			for(var i=0;i&lt;container.length;i++)&#123;</span><br><span class="line">				ulHeight.push(container[i].offsetHeight);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			var isMinHeight = ulHeight[0];</span><br><span class="line">			for(var j=0;j&lt;ulHeight.length;j++)&#123;</span><br><span class="line">				isMinHeight = Math.min(isMinHeight,ulHeight[j]);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			var isMinIndex = ulHeight.indexOf(isMinHeight);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">			var isMinUl = container[isMinIndex];</span><br><span class="line"></span><br><span class="line">			var newLi = document.createElement(&quot;li&quot;);</span><br><span class="line">			newLi.className = &quot;itemBox&quot;;</span><br><span class="line">			newLi.appendChild(newImage);</span><br><span class="line">			isMinUl.appendChild(newLi);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		imageCount.push(1);</span><br><span class="line">		console.log(imageCount.length)</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for(var k=0;k&lt;15;k++)&#123;</span><br><span class="line">	createLi()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">EventUntil.addHandler(window,&quot;mousewheel&quot;,function(event)&#123;</span><br><span class="line">	var deltai = EventUntil.getWheelDelta(event);</span><br><span class="line">	if(deltai&lt;0)&#123;</span><br><span class="line">		if(document.body.scrollTop||document.documentElement.scrollTop + document.body.clientHeight == document.body.scrollHeight)&#123;</span><br><span class="line">			for(var k=0;k&lt;15;k++)&#123;</span><br><span class="line">				createLi()</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;	</span><br><span class="line">	</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/20/JS事件(3)EventUntil对象/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/20/JS事件(3)EventUntil对象/" itemprop="url">JS事件(3)EventUtil对象</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-20T00:00:00+08:00">
                2016-10-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">var EventUtil = &#123;</span><br><span class="line">		addHandler: function(element, eventType, handler)&#123;</span><br><span class="line">			if (element.addEventListener)&#123;</span><br><span class="line">				// 所有现代浏览器都可以使用的方法，IE9，firefox，chrome</span><br><span class="line">				element.addEventListener(eventType, handler, false)</span><br><span class="line">			&#125; else if (element.attachEvent)&#123;</span><br><span class="line">				// 主要是为了兼容 IE8，IE8 是最后一个使用专用事件系统的主流浏览器。</span><br><span class="line">				element.attachEvent( &apos;on&apos; + eventType, handler)</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				element[&apos;on&apos; + eventType] = handler;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		getEvent: function (event) &#123;</span><br><span class="line">			return event || window.event</span><br><span class="line">			/*在 IE 中使用 DOM0 级方法添加事件时， event 对象将会作为 window</span><br><span class="line">			对象的一个属性存在。若是使用 attachEvent() 方法添加事件，便会有一个 event 对象作为参数被传入事件处理程序函数中。如果是通过 HMTL 特性指定事件处理程序，那么还可以通过一个 event 的变量来访问 event 对象。*/</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		getTarget: function (event)&#123;</span><br><span class="line">			return event.target || event.srcElement</span><br><span class="line">			// target 现代浏览器</span><br><span class="line">			// srcElement IE8 以下</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		preventDefault: function(event)&#123;</span><br><span class="line">			if (event.preventDefault)&#123;</span><br><span class="line">				event.preventDefault()</span><br><span class="line">				// 阻止现代浏览器默认事件</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				event.returnValue = false</span><br><span class="line">				// 阻止 IE8 默认事件</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		stopPropagation: function(event)&#123;</span><br><span class="line">			// IE8 不支持事件捕获，因此在夸浏览器的情况下，该方法只能用来阻止事件冒泡。</span><br><span class="line">			if(event.stopPropagation)&#123;</span><br><span class="line">				event.stopPropagation()</span><br><span class="line">				// 阻止现代浏览器事件传播</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				event.cancelBubble = true;</span><br><span class="line">				// 阻止 IE8 事件传播</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		getWheelDelta:function()&#123;</span><br><span class="line">			// 总是返回 120 的倍数，为正表示鼠标滚轮向上滚动</span><br><span class="line">			// 获取鼠标滑轮增量</span><br><span class="line">			if(event.wheelDelta)&#123;</span><br><span class="line">				// 主流浏览中 mousewhell 中的 wheelDelta</span><br><span class="line">				/*当鼠标滚轮向前滑动时，wheelDelta 是120的倍数；当滚轮向后滑动时，wheelDelta 是 -120 的倍数。*/</span><br><span class="line">				return (client.engine.opera &amp;&amp; client.engine.opera &lt; 9.5 ? -event.wheelDelta : event.wheelDelta);</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				/* FireFox 支持的是一个 DOMMouseScroll 的类似事件，而有关鼠标滚轮有关的信息则保存在 detail 属性中，当向前滑动鼠标滚轮时，该属性的值是 -3 的倍数，当向后滑动鼠标滚轮时，该属性值是 3 的倍数。*/</span><br><span class="line">				return -event.detail*40;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		getPageCoordinates: function(event)&#123;</span><br><span class="line">			// 获取鼠标在页面中的位置</span><br><span class="line">			var pageX = event.pageX</span><br><span class="line">			var pageY = event.pageY</span><br><span class="line">			// IE8 不支持事件对象上的页面坐标，所以需要通过 client 偏移量 和 scroll 偏移量来计算</span><br><span class="line">			if (pageX === undefined)&#123;</span><br><span class="line">				pageX = event.clientX + (document.documentElement.scrollLeft || document.body.scrollLeft)</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			if (pageY === undefined)&#123;</span><br><span class="line">				pageY = event.clientY + (document.documentElement.scrollTop || document.body.scrollTop)</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			return &#123;</span><br><span class="line">				&apos;pageX&apos;: pageX,</span><br><span class="line">				&apos;pageY&apos;: pageY</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		removeHandler: function(element, eventType, handler)&#123;</span><br><span class="line">			if(element.removeEventListener)&#123;</span><br><span class="line">				element.removeEventListener(eventType, handler, false)</span><br><span class="line">			&#125; else if (element.detachEvent)&#123;</span><br><span class="line">				element.detachEvent(&apos;on&apos; + eventType, handler)</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				element[&apos;on&apos; + eventType] = null;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/17/Burpsuite/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/17/Burpsuite/" itemprop="url">Burpsuite</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-17T20:50:00+08:00">
                2016-10-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-Burpsuite-简介"><a href="#0x00-Burpsuite-简介" class="headerlink" title="0x00 Burpsuite 简介"></a>0x00 Burpsuite 简介</h3><p>Burpsuite 享有 Web 安全工具中的瑞士军刀的美誉。是由 PortSwigger 公司开发的统一的集成工具用以发现全部现代 Web 安全漏洞。不开源，但是有免费版。免费版不支持主动扫描。</p>
<hr>
<h3 id="0x01-Proxy"><a href="#0x01-Proxy" class="headerlink" title="0x01 Proxy"></a>0x01 Proxy</h3><hr>
<h4 id="导入证书"><a href="#导入证书" class="headerlink" title="导入证书"></a>导入证书</h4><p>我们可以在 Burpsuite 应用程序能导出证书。<br><img src="http://upload-images.jianshu.io/upload_images/1571420-6c2270b076615c2b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="CA certificate"></p>
<p>也可以在浏览器中设置 Burpsuite Proxy 后访问 <a href="http://brup" target="_blank" rel="noopener">http://brup</a> 地址获得 证书。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-3a3a518b75ddfbca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="http://brup"></p>
<p>导入证书以后，便可以在使用 Proxy 代理的情况下访问使用 Https 的网站了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-e8e3b9561c91985b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Intercept is on"></p>
<hr>
<h4 id="Intercept-截断"><a href="#Intercept-截断" class="headerlink" title="Intercept 截断"></a>Intercept 截断</h4><p>Burpsuite 在默认情况下会截断所有从客户端发起的请求。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-8d9d28164876d4d9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Intercept"></p>
<p>截断客服端请求/服务器端响应设置:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-31e28066f7a82e93.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></p>
<p>修改响应信息:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-f3cc127519d2f7bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Rsponse Modification"></p>
<p>匹配和替换:<br>使用匹配和替换功能可以帮助我们去自动的修改请求或者响应的信息，以节省时间成本。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-d2ed29c4ba9aa865.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Math and Replace"></p>
<hr>
<h4 id="Proxy-中-Invisible-功能"><a href="#Proxy-中-Invisible-功能" class="headerlink" title="Proxy 中 Invisible 功能"></a>Proxy 中 Invisible 功能</h4><p>Invisible 功能可以使得不支持代理的客户端通过使用 DNS 污染使其转而支持 Burpsuite 代理。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1571420-51033915b24bf7aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Proxy-Invisible"></p>
<p>未完待续</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/16/2.DOM扩展/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onejustonee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="onejustone">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/16/2.DOM扩展/" itemprop="url">JS-DOM(2)-DOM扩展</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-16T00:00:00+08:00">
                2016-10-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/technology/" itemprop="url" rel="index">
                    <span itemprop="name">technology</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="0x00-HTML-扩展"><a href="#0x00-HTML-扩展" class="headerlink" title="0x00 HTML 扩展"></a>0x00 HTML 扩展</h3><hr>
<h4 id="焦点管理"><a href="#焦点管理" class="headerlink" title="焦点管理"></a>焦点管理</h4><p>使用 HTML5 中的 焦点管理属性 <strong>document.activeElement</strong>，便始终会引用 DOM 中当前获得了焦点的元素。</p>
<p>默认情况下，页面加载完成时，document.activeElement 中保存的是 body 元素的引用；文档加载期间，保存的值为 null。</p>
<p>此外，document.hasFocus() 可以确定文档是否获得了焦点。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var button = document.getElementById(&quot;myBtn&quot;);</span><br><span class="line">button.focus();</span><br><span class="line">alert(document.hasFocus());</span><br></pre></td></tr></table></figure>
<p>通过此方法，我们可以知道用户是不是正在与页面交互。</p>
<blockquote>
<p>元素获得焦点的方式有:页面加载，用户输入（按 tab 键）和在代码中调用 focus() 方法.</p>
</blockquote>
<hr>
<h4 id="HTMLDocument-的变化"><a href="#HTMLDocument-的变化" class="headerlink" title="HTMLDocument 的变化"></a>HTMLDocument 的变化</h4><p>HTML5 扩展了 HTMLDocument ，增加了新的功能功能。</p>
<h5 id="readyState-属性"><a href="#readyState-属性" class="headerlink" title="readyState 属性"></a>readyState 属性</h5><p>Document 的 readyState 属性可能有两个值:</p>
<ul>
<li>loading,正在加载文档</li>
<li>complete,已经加载完文档</li>
</ul>
<p>其基本用法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(document.readyState == &quot;complete&quot;)&#123;</span><br><span class="line">    //body</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="自定义数据属性"><a href="#自定义数据属性" class="headerlink" title="自定义数据属性"></a>自定义数据属性</h4><p>HTML5 规定可以为元素添加非标准的属性，但是要加前缀 <strong>data-</strong> ,目的是为元素提供与渲染无关的信息，或者提供语义信息。在跟踪链接或者混搭应用中，通过自定义属性能方便的知道来自页面的哪个部分。然后我们可以使用 <strong>dataset</strong> 属性来访问自定义的属性值。</p>
<hr>
<h3 id="0x01-内存与性能问题"><a href="#0x01-内存与性能问题" class="headerlink" title="0x01 内存与性能问题"></a>0x01 内存与性能问题</h3><p>当删除带有事件处理程序或引用其他 JS 对象子树的时候便有可能导致性能问题。所以我们有必要在使用这些属性前手动删除被替换元素的所有事件处理和 JS 对象属性。</p>
<p>不过，使用这几个属性，便利也是显而易见的，比如 innerHTML ,在插入大量 HTML 标记时使用 innerHTML 属性与通过多次 DOM 操作先创建节点在指定它们之间的关系相比，效率要高得多。因为在使用 inerHTML 或者 outerHTML 属性时会先创建一个 HTML 的解析器。该解析器是在浏览器级别基础上运行的。因此比执行 JS 代码要快的多。但是，创建和销毁 HTML 解析器也会带来性能损失，所以最好能将使用 innerHTML 或者 outerHTML 的次数控制在合理范围内。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var itemsHtml = &quot;&quot;;</span><br><span class="line">for( var i = 0,len = values.length;i &lt; len; i ++)&#123;</span><br><span class="line">    itemsHtml += &quot;&lt;li&gt; + values[i] + &lt;/li&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">ul.innerHTML = itemsHtml;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/15/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><span class="space">&hellip;</span><a class="page-number" href="/page/33/">33</a><a class="extend next" rel="next" href="/page/17/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">onejustonee</p>
              <p class="site-description motion-element" itemprop="description">onejustone's blog</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">329</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">103</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">onejustonee</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
