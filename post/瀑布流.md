---
title: 瀑布流  
date: 2016-10-20  
tags: ['JS小项目']
toc: true
categories: technology

---
### 0x00 瀑布流

HTML 代码
```
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>瀑布流</title>
	<link rel="stylesheet" type="text/css" href="pubuliu.css">
</head>
<body>
	<id id="weaper">
		<ul class="container"><li class="itemBox"></li></ul>		
		<ul class="container"></ul>
		<ul class="container"></ul>
		<ul class="container"></ul>
	</id>
</body>
<script type="text/javascript" src="pubuliu.js"></script>
</html>
```

CSS  代码
```
*{
	margin: 0;
	padding: 0;
	list-style:none;
	box-sizing: border-box;

}

body{
	background: red;
	max-width: 1200px;
	overflow-y: scroll;
	
}

.container {
	float: left;
	width: 22%;
	padding: 10px;
	border: 1px solid green;
	margin: 1%;
}

.itemBox {
	width: 100%;
	
}

.itemBox img {
	width: 100%;
}
```

JS 代码
```
var container = document.querySelectorAll(".container");
console.log(container)
var imageCount = [1];

var EventUntil = {
	addHandler: function(element,type,handler){
		if(element.addEventListener){
			element.addEventListener(type, handler);
		} else if (element.attachEvent){
			element.attachEvent(type, handler);
		} else {
			element["on" + type] = handler;
		}
	},

	getEvent: function(event){
		return event ? event : window.event;
	},

	getTarget: function(event){
		return event.target || event.srcElement;
	},
	preventDefault: function(event){
		if(event.preventDefault){
			event.preventDefault();
		} else {
			event.returnValue = false;
		}
	},
	removeHandler: function(){
		if (element.removeElementListener){
			element.removeElementListener(type,handler);
		} else if (element.detachEvent){
			element.detachEvent;
		} else {
			element["on" + type] = null;
		}
	},
	stopPropagation: function(){
		if(event.stopPropagation){
			event.stopPropagation();
		} else{
			event.cancelBubble = true;
		}
	},

	getWheelDelta:function(event){
		if(event.wheelDelta){
			return event.wheelDelta;
		} else {
			return -event.detail*40;
		}
	},

};

function createLi (){

	if(imageCount.length <= 75){
		var newImage = new Image();
		newImage.src = "rendering/"+imageCount.length + "-" + ".jpg";
		newImage.onload = function (){
			var ulHeight = []

			for(var i=0;i<container.length;i++){
				ulHeight.push(container[i].offsetHeight);
			}

			var isMinHeight = ulHeight[0];
			for(var j=0;j<ulHeight.length;j++){
				isMinHeight = Math.min(isMinHeight,ulHeight[j]);
			}

			var isMinIndex = ulHeight.indexOf(isMinHeight);


			var isMinUl = container[isMinIndex];

			var newLi = document.createElement("li");
			newLi.className = "itemBox";
			newLi.appendChild(newImage);
			isMinUl.appendChild(newLi);

		}
		imageCount.push(1);
		console.log(imageCount.length)
	}
	
	
	
}

for(var k=0;k<15;k++){
	createLi()
}

EventUntil.addHandler(window,"mousewheel",function(event){
	var deltai = EventUntil.getWheelDelta(event);
	if(deltai<0){
		if(document.body.scrollTop||document.documentElement.scrollTop + document.body.clientHeight == document.body.scrollHeight){
			for(var k=0;k<15;k++){
				createLi()
			}
		}
	}	
	
})
```

