# 面向对象

---

title: Python(8)-对象-属性-和-类
date: 2016-04-24 17:06
tags: ['Python基础']
toc: true
categories: technology

## 0x00 对象 属性 类 和方法

---

Python使用 __类(class)__ 和 __对象(object)__ 进行 __面向对象(object-oriented programing,简称oop)__ 的编程 ，面向对象的目的是为了提高程序的重复使用性，Python 的整个概念都是基于对象的。

下面我们来定义一个鸟类:

```python
class Bird(object):
    have_feather = True
    way_of_reproduction = "egg"

# 定义了一个Bird类，并且它有两个和属性，长毛(have_feather)和下蛋(egg)

summer = Bird()
#创建Bird的一个对象summer，由此summer便有了Bird的属性
print summer.way_of_reproduction
#通过" 对象.属性(object.attribute) "的形式实现对属性的引用
```

类的内部定义的函数就是 __方法(method)__

```python
class Bird(object):
        have_feather = True
        def move(self,dx,dy):
              position = [0,0]
              position[0] = position[0]+dx
              position[1] = position[1]+dy
              retutn position
summer = Bird()
print "after move:",summer.move(5,8)
```

看，我们从新定义了一个 `Bird` 类，为它增加了一个方法属性，方法的第一个参数是 `self`，无论是否用到，`self` 是为了方便内部使用，引用对象自身。

## 0x01  对象的继承(inheritance)

---

```python
class Chicken(Bird):
        way_of_move = 'walk'

summer = Chicken()
print summer.have_feather
print summer.move(9,19)
```

新定义的鸡类`Chicken`增加了一个属性:移动方式`way_of_move`

在定义鸡类时，括号里面是`Bird`,这说明`Chicken`是`Bird`的一个子类，即`Chicken`继承自`Bird`，`Bird`也就是`Chicken`的父类了，`Chicken`将享有`Bird`的所有属性(方法也是一种属性),如果括号里是`Object`则说明该类是个父类，到头了。

---

## 0x02 关于 self

`self`的作用是方便在类的内部调用其方法，如下:

```python
class human(object):
        laugh='hahaha'
        def show_laugh(self):
              print self.laugh
        def laugh_100th(self):
              self.show_laugh()

li_lei = human()
li_lei.laugh_100th()
```

这里有一个类属性`laugh`，方法`show_laugh()`中，通过`self.laugh`，调用了该属性的值。

---

## 0x03 `__init__`

`__init__`可以理解为__方法的初始化__，可以理解为一般编程语言中构造方法，Python __特殊方法(special method)__中的一种

```python
class happBird(Bird):
    def __init__(self,more_words):
        print "we are happy birds.",more_words

summer = happyBird('happy,happy,haha')

# 运行结果：
we are happy birds.happy,happy,haha
```

可以看到，尽管我们只是创建了 `summer` 对象，但是`__init__`方法被自动调用了！

---

## 0x04 对象的性质

我们上面讲到的属性都是类的属性，所有属于该类的对象都会共享这些属性，下面我们来看看对象的性质

```python
class Human(object):
    def __init__(self, input_gender):
          self.gender=input_gender
    def printGender(self):
          print self.gender

li_lei = Human('male')
#‘male’作为参数传递给__init__()方法的input_gender变量
print li_lei.gender
li_lei.printGender()
```

当我们定义方法时，必须要传递`self`参数，这个参数代表的就是类的一个对象，然后我们通过操纵`self`来修改某个对象的性质，如上:新建了的`li_lei`对象就被`self`表示，我们通过赋值给`self.attribute`，给`li_lei`添加一些性质。

对象的性质也可以被其它方法调用，调用方法与类属性的调用相似，正如在printGender()方法中的调用。

---

## 0x05 对象的属性

Python 一切皆对象(`object`),每个对象都可能有多个属性(`attribute`),Python的属性有一套统一的管理方案。

* 属性的`__dict__`系统

对象的属性可能来自其类定义，叫做类属性(`class attribute`),而类属性可能来源于类自身，也可能根据类定义继承来的，一个对象的属性还可能是该对象实例定义的，叫做对象属性(`object attribute`)

Python中对象的属性存储在对象的\_\_dict\_\_属性中，\_\_dict\_\_为一个词典，键为属性名，对应的值为属性本身,。当然Python自身也会生成一些类，而这些类并不是我们自己定义的

```python
class bird(object):
	feather = True

class chicken(bird):
	fly = False
	def __init__(self, age):
		self.age = age

summer = chicken(2)
print(bird.__dict__)
{'__dict__': <attribute '__dict__' of 'bird' objects>, '__module__': '__main__', '__weakref__': <attribute '__weakref__' of 'bird' objects>, 'feather': True, '__doc__': None}
print(chicken.__dict__)
{'fly': False, '__module__': '__main__', '__doc__': None, '__init__': <function __init__ at 0x0000000003141128>}
print(summer.__dict__)
{'age': 2}
```

可以看到Pyhton中的属性是分层定义的，当我们有一个summer对象的时候，分别查询summer对象，chiken类，bird类以及object类的属性，就可以知道summer对象所有的dict，然后就可以找到通过对象summer可调用和修改的所有属性了

如果只有一个对象，而不知道它的类以及其他信息的时候，我们可以利用\_\_class\_\_属性找到对象的类，然后调用类的\_\_base\_\_属性查询父类

```python
print(summer.__class__)
<class '__main__.chicken'>
print(chicken.__base__)
<class '__main__.bird'>
```

---

## 0x06 特性

同一个对象的不同属性之间可能存在依赖关系，有时我们希望当某个属性被修改时，依赖于该属性的其它属性也同时变化，这时通过\_\_dict\_\_方式来静态的存储属性并不适用。Pyhton提供了多种即时生成属性的方法，其中一种称为特性(`property`),特性是特殊的属性。

```python
class bird(object):
    feather = True


class chicken(bird):
    fly = False
    def __init__(self, age):
        self.age = age

    def getAdult(self):
        if self.age > 1.0:
            return True
        else:
            return False

    adult = property(getAdult)

summer = chicken(2)
print(summer.adult)
summer.age = 0.5
print(summer.adult)
```

特性使用内置函数property()来创建，property()最多可加载四个函数，前三个参数为函数，分别用于处理查询特性，修改特性，删除特性，最后一个参数为特性的文档，可以为一个字符串，起说明作用。

再来看一个例子

```python
class num(object):
    def __init__(self, value):
        self.value = value
    def getNeg(self):
        return -self.value
    def setNge(self, value):
        self.value = -value
    def delNeg(self):
        print("value also delete!")
        del self.value
    neg = property(getNeg, setNge, delNeg, "i am a negative")

x = num(1.1)
print(x.neg)
x.neg = -22
print(x.value)
print(num.neg.__doc__)
del x.neg
```

上面`num`为一个数字，而`neg`为一个特性，用来表示数字的负数
`delNeg`表示，如果删除特性`neg`，那么应该执行的操作是删除属性`value`。`property()`的最后一个参数为特性`neg`的说明文档。

