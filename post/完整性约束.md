---
title: SQL完整性约束
date: 2016-07-05 12:26
tags: ['SQL查询的艺术','完整性约束']
toc: true
categories: technology

---
### 0x00 简介
约束是用来确保数据的准确性和一致性。数据的完整性就是对数据的准确性和一直性的一种保证。数据完整性(Data Integrity)是指数据的精确性(Accuracy)和可靠性(Reliability)。

数据完整性分为以下四类:
* 实体完整性:表的每一行在表中是唯一的实体。
* 参照完整性:两个表的主关键字和外关键字的数据应该一致。
* 域完整性:表中的列必须满足某种特定的数据类型或者约束
* 用户自定义完整性


SQL完整性约束分为3种类型，与表有关的约束，域(Domain)约束，断言(Assertion)约束。

与表有关的约束包括列约束和表约束，表约束包括UNIQUE约束，PRIMARY KEY 约束，FOREIGN KEY约束和CHECK约束；列约束除了包括表约束外还包括NOT NULL约束。

---
### 0x01 表约束与列约束

---
#### NOT NULL and UNIQUE
NOT NULL代表该列不接受空值；UNIQUE约束列可以接受空值，但是最多只可以出现一个NULL，如果有两行空值，则代表违背了其唯一性原则。

---
#### PRIMARY KEY and FOREIGEN KEY
主键约束，起唯一标识作用，不能不为NULL，不能重复。
值得注意的是，不能为同一个列或一组列即定义UNIQUE约束又定义PRIMARY KEY约束。

##### 创建PRIMARY KEY约束

```
CREATE TABLE StudentInfo
(Sno INT PREMARY KEY,
Name VARCAHRE(20),
Address VARCHARE(20) UNIQUE
)
```

FOREIGN KEY约束定义了一个表中的数据与另一个表中数据的联系。

FOREIGN KEY指定一个列或者一组列作为外部键，其中，包含外部键的表称为子表，包含外部键所引用的主键的表称为父表。系统保证在外部键的取值要么是父表中某一个主键，要么取空值，确保了__实体的参照完整性__。

##### 创建FOREIGN KEY约束

```
CREATE TABLE Emp_Sal
(EMP_ID INT REFERENCES Eminfo (EMP_ID),
Salary decimal(5,1),
Bank_Account CHAR(8))
```

EMP_ID被指定为Empty_Sal的外键，参照了Eminfo中的EMP_ID列。
此时，表Emp_Sal就是子表，表Eminfo就是父表。
如果一个表中有多列创建了FOREIGN KEY约束，将分别于多个表中的相应主键相对应。


关系数据规定子表中的每个FOREIGN KEY值必须作为主键值存在于父表中，该准则为__引用完整性约束__。

---
#### CHECK 约束
CHECK约束用来检查字段值所允许的范围。如一个字段只能输入整数，而且只能是1-1000这个范围内的。






