---
title: JS-DOM(2)-DOM扩展   
date: 2016-10-16   
tags: ['JavaScript','DOM']
toc: true
categories: technology

---
### 0x00 HTML 扩展
---
#### 焦点管理
使用 HTML5 中的 焦点管理属性 **document.activeElement**，便始终会引用 DOM 中当前获得了焦点的元素。

默认情况下，页面加载完成时，document.activeElement 中保存的是 body 元素的引用；文档加载期间，保存的值为 null。

此外，document.hasFocus() 可以确定文档是否获得了焦点。

```
var button = document.getElementById("myBtn");
button.focus();
alert(document.hasFocus());
```

通过此方法，我们可以知道用户是不是正在与页面交互。

> 元素获得焦点的方式有:页面加载，用户输入（按 tab 键）和在代码中调用 focus() 方法.

---
#### HTMLDocument 的变化
HTML5 扩展了 HTMLDocument ，增加了新的功能功能。

##### readyState 属性

Document 的 readyState 属性可能有两个值:

* loading,正在加载文档
* complete,已经加载完文档

其基本用法:

```
if(document.readyState == "complete"){
    //body
}
```

---
#### 自定义数据属性
HTML5 规定可以为元素添加非标准的属性，但是要加前缀 **data-** ,目的是为元素提供与渲染无关的信息，或者提供语义信息。在跟踪链接或者混搭应用中，通过自定义属性能方便的知道来自页面的哪个部分。然后我们可以使用 **dataset** 属性来访问自定义的属性值。


---
### 0x01 内存与性能问题
当删除带有事件处理程序或引用其他 JS 对象子树的时候便有可能导致性能问题。所以我们有必要在使用这些属性前手动删除被替换元素的所有事件处理和 JS 对象属性。

不过，使用这几个属性，便利也是显而易见的，比如 innerHTML ,在插入大量 HTML 标记时使用 innerHTML 属性与通过多次 DOM 操作先创建节点在指定它们之间的关系相比，效率要高得多。因为在使用 inerHTML 或者 outerHTML 属性时会先创建一个 HTML 的解析器。该解析器是在浏览器级别基础上运行的。因此比执行 JS 代码要快的多。但是，创建和销毁 HTML 解析器也会带来性能损失，所以最好能将使用 innerHTML 或者 outerHTML 的次数控制在合理范围内。


```
var itemsHtml = "";
for( var i = 0,len = values.length;i < len; i ++){
    itemsHtml += "<li> + values[i] + </li>";
}
ul.innerHTML = itemsHtml;
```




